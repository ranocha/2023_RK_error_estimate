(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     74220,       1863]
NotebookOptionsPosition[     69402,       1773]
NotebookOutlinePosition[     69805,       1789]
CellTagsIndexPosition[     69762,       1786]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["L1 residual error estimators", "Title"]], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.898235828758728*^9, 3.898235851122744*^9}},
 CellLabel->"",ExpressionUUID->"a4cac3ee-ae75-47d7-b24b-cbf38894729c"],

Cell[TextData[StyleBox["This notebook contains calculations for analyzing \
step size control stability with L1 residual error estimators.", "Text"]], \
"Input",
 Evaluatable->False,
 CellChangeTimes->{{3.898237161513392*^9, 3.8982372333657913`*^9}},
 FormatType->"TextForm",
 CellLabel->"",ExpressionUUID->"a6c14376-0133-4e47-a231-5e7ccff365dd"],

Cell[CellGroupData[{

Cell["Step size control stability for explicit Euler", "Section",
 CellChangeTimes->{{3.89823586184969*^9, 3.898235862727674*^9}, {
  3.898237101313854*^9, 3.898237120600312*^9}, {3.8982387562661953`*^9, 
  3.8982387674728127`*^9}},
 FormatType->
  "TextForm",ExpressionUUID->"d5e144a0-c4d1-4dbb-a41b-51d235afc8c0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", 
    RowBox[{
     RowBox[{"tn", "\[GreaterEqual]", "0"}], "&&", 
     RowBox[{"hn", ">", "0"}], "&&", 
     RowBox[{"tol", ">", "0"}], "&&", 
     RowBox[{"\[Eta]n", ">", "0"}], "&&", 
     RowBox[{"\[Chi]n", ">", "0"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnp1", "=", 
   RowBox[{"tn", "+", "hn"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", "z_", "]"}], ":=", 
  RowBox[{"1", "+", "z"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unp1", "=", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"hn", "*", "\[Lambda]"}], "]"}], "*", "un"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Linear", " ", "reconstruction"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"un", "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"tnp1", "-", "tn"}], ")"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"unp1", "-", "un"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"Duhat", "=", 
    RowBox[{"D", "[", 
     RowBox[{"uhat", ",", "t"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"integrand", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"Duhat", "-", 
     RowBox[{"\[Lambda]", "*", "uhat"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.896233895699747*^9, 3.8962339231542177`*^9}, {
  3.8962348331808863`*^9, 3.896234939864752*^9}, {3.8962349760102577`*^9, 
  3.8962351161127443`*^9}, {3.8962351673070908`*^9, 3.896235168608932*^9}, {
  3.896236695509398*^9, 3.896236703170928*^9}, {3.896238176290915*^9, 
  3.896238193782948*^9}, {3.896244421426671*^9, 3.8962444263608007`*^9}, {
  3.897121151210969*^9, 3.8971212058990602`*^9}, {3.898237137970739*^9, 
  3.8982371383362627`*^9}, {3.898237481019886*^9, 3.898237482419362*^9}, {
  3.898237574122312*^9, 3.898237574786117*^9}, {3.8982376437833843`*^9, 
  3.8982376512627163`*^9}, {3.8982379800633583`*^9, 3.898238015881113*^9}, {
  3.898320363089723*^9, 3.898320374583438*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"cabe4e6b-1735-443f-95cf-b185a72de295"],

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "t"}], "+", "tn"}], ")"}], " ", "un", " ", 
   SuperscriptBox["\[Lambda]", "2"]}], "]"}]], "Output",
 CellChangeTimes->{3.898238019741047*^9, 3.898238988011077*^9, 
  3.8983203750813828`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"a7dc76ec-6fd7-4e21-8d27-67811412b6d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"estimateL1", "=", 
  RowBox[{
   RowBox[{"Simplify", "@", 
    RowBox[{"Integrate", "[", 
     RowBox[{"integrand", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "tn", ",", "tnp1"}], "}"}]}], "]"}]}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "*", 
      RowBox[{"Conjugate", "[", "\[Lambda]", "]"}]}], "\[Rule]", 
     RowBox[{
      RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "2"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.89832037971165*^9, 3.89832038069555*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"61b39d43-e0ce-4976-90ae-2e4896241748"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["hn", "2"], " ", 
  RowBox[{"Abs", "[", 
   RowBox[{"un", " ", 
    SuperscriptBox["\[Lambda]", "2"]}], "]"}]}]], "Output",
 CellChangeTimes->{3.898320381386606*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"7ebc5861-0519-42d3-a6b5-048521ebd745"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[Eta]", " ", "=", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"Abs", "[", "u", "]"}], "]"}]}], ",", " ", 
    RowBox[{"\[Chi]", " ", "=", " ", 
     RowBox[{"Log", "[", "h", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"Log", "[", 
     RowBox[{"Abs", "[", "unp1", "]"}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{"\[Eta]n", "+", 
       RowBox[{"Log", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{"Exp", "[", "\[Chi]n", "]"}], "*", "\[Lambda]"}], "]"}], 
         "]"}], "]"}]}], ",", "\[Lambda]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"hnp1", "=", 
    RowBox[{
     RowBox[{"hn", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"tol", "/", "estimateL1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"\[Beta]1", "/", "k"}], ")"}]}]}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"un", "*", 
        RowBox[{"Conjugate", "[", "un", "]"}]}], "\[Rule]", 
       RowBox[{
        RowBox[{"Abs", "[", "un", "]"}], "^", "2"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Chi]np1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Log", "[", "hnp1", "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "un", "]"}], "\[Rule]", 
         RowBox[{"Exp", "[", "\[Eta]n", "]"}]}], ",", 
        RowBox[{"hn", "\[Rule]", 
         RowBox[{"Exp", "[", "\[Chi]n", "]"}]}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.896235423525207*^9, 3.896235472803173*^9}, 
   3.8962362799480333`*^9, {3.896236485917211*^9, 3.8962366165394707`*^9}, {
   3.896236653275103*^9, 3.896236684858735*^9}, {3.896236717786442*^9, 
   3.896236896040264*^9}, {3.896236933876235*^9, 3.896237071310083*^9}, {
   3.896237108167096*^9, 3.896237162712697*^9}, {3.896237213311355*^9, 
   3.896237354910881*^9}, {3.896237385900876*^9, 3.8962375073440332`*^9}, {
   3.896237537368074*^9, 3.8962375457920017`*^9}, 3.896237582235783*^9, {
   3.896238296647077*^9, 3.896238319821246*^9}, {3.8962384914368057`*^9, 
   3.8962385045147963`*^9}, {3.8962386541803627`*^9, 3.896238823654738*^9}, {
   3.8962390158723497`*^9, 3.8962390161323957`*^9}, {3.896239203809816*^9, 
   3.8962392039132977`*^9}, {3.896239374786807*^9, 3.896239375151299*^9}, {
   3.89623941142618*^9, 3.896239520359416*^9}, {3.8962395506459703`*^9, 
   3.896239598499967*^9}, {3.8962396913423777`*^9, 3.8962396986075373`*^9}, {
   3.896244418036598*^9, 3.8962444186737537`*^9}, {3.8963319714572487`*^9, 
   3.896331972140767*^9}, {3.89633210013013*^9, 3.896332163356917*^9}, {
   3.896332265740583*^9, 3.896332266712929*^9}, {3.8971212356219893`*^9, 
   3.897121273074278*^9}, {3.897121372181244*^9, 3.8971213905237617`*^9}, {
   3.897121438427998*^9, 3.897121450695888*^9}, {3.897121487868581*^9, 
   3.897121488455649*^9}, {3.898237602029159*^9, 3.8982376249426203`*^9}, {
   3.898237840265954*^9, 3.8982378589347343`*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"48c9e826-a9a4-4159-adce-335c0f2618e8"],

Cell[BoxData[
 RowBox[{"\[Eta]n", "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[Chi]n"}]], " ", 
      SuperscriptBox[
       RowBox[{"Im", "[", "\[Lambda]", "]"}], "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}]}], ")"}], "2"]}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244429655254*^9, 3.8962473342342663`*^9, {
   3.896331965688078*^9, 3.896331972859754*^9}, {3.896332100749403*^9, 
   3.896332163853244*^9}, 3.896332267813305*^9, 3.897121047690755*^9, {
   3.897121236370434*^9, 3.897121273709721*^9}, {3.8971213688453703`*^9, 
   3.897121391033291*^9}, {3.897121422905861*^9, 3.897121489043169*^9}, {
   3.898237605082697*^9, 3.898237625917707*^9}, 3.898237656664256*^9, 
   3.898237769506495*^9, 3.898237846018979*^9, 3.89823802623549*^9, 
   3.898238988145718*^9},
 CellLabel->
  "Out[255]=",ExpressionUUID->"375c9712-d0a8-4f95-a3d8-3a177e231764"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["2", 
   FractionBox["1", "k"]], " ", "hn", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["tol", 
     SuperscriptBox["hn", "2"]], ")"}], 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", 
     RowBox[{"Abs", "[", "un", "]"}]], ")"}], 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Lambda]", "]"}], "2"]], ")"}], 
   FractionBox["1", "k"]]}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244429655254*^9, 3.8962473342342663`*^9, {
   3.896331965688078*^9, 3.896331972859754*^9}, {3.896332100749403*^9, 
   3.896332163853244*^9}, 3.896332267813305*^9, 3.897121047690755*^9, {
   3.897121236370434*^9, 3.897121273709721*^9}, {3.8971213688453703`*^9, 
   3.897121391033291*^9}, {3.897121422905861*^9, 3.897121489043169*^9}, {
   3.898237605082697*^9, 3.898237625917707*^9}, 3.898237656664256*^9, 
   3.898237769506495*^9, 3.898237846018979*^9, 3.89823802623549*^9, 
   3.8982389881582527`*^9},
 CellLabel->
  "Out[257]=",ExpressionUUID->"636c95b4-4c0d-4204-9336-34bf9d75f639"],

Cell[BoxData[
 RowBox[{"Log", "[", 
  RowBox[{
   SuperscriptBox["2", 
    FractionBox["1", "k"]], " ", 
   SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Eta]n"}], "-", 
        RowBox[{"2", " ", "\[Chi]n"}]}]], " ", "tol"}], ")"}], 
    FractionBox["1", "k"]], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Lambda]", "]"}], 
    RowBox[{
     RowBox[{"-", "2"}], "/", "k"}]]}], "]"}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244429655254*^9, 3.8962473342342663`*^9, {
   3.896331965688078*^9, 3.896331972859754*^9}, {3.896332100749403*^9, 
   3.896332163853244*^9}, 3.896332267813305*^9, 3.897121047690755*^9, {
   3.897121236370434*^9, 3.897121273709721*^9}, {3.8971213688453703`*^9, 
   3.897121391033291*^9}, {3.897121422905861*^9, 3.897121489043169*^9}, {
   3.898237605082697*^9, 3.898237625917707*^9}, 3.898237656664256*^9, 
   3.898237769506495*^9, 3.898237846018979*^9, 3.89823802623549*^9, 
   3.898238988399194*^9},
 CellLabel->
  "Out[258]=",ExpressionUUID->"c20f3c2a-c8db-448a-8217-d5db2387b6d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"jacobian", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Eta]np1", ",", "\[Chi]np1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Eta]n", ",", "\[Chi]n"}], "}"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{"z", "/", 
       RowBox[{"Exp", "[", "\[Chi]n", "]"}]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"jacobian", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", 
   RowBox[{"Re", "[", 
    RowBox[{"z", "/", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", "z"}], " ", ")"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ev", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Eigenvalues", "[", "jacobian", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.896237605625327*^9, 3.8962376059263783`*^9}, {
   3.8962382371898947`*^9, 3.896238268598114*^9}, {3.896238326931666*^9, 
   3.896238350855088*^9}, 3.896238478054233*^9, {3.8962385096854362`*^9, 
   3.8962385110823517`*^9}, {3.896238842089006*^9, 3.896238844525835*^9}, {
   3.896238886801694*^9, 3.8962389184171457`*^9}, {3.896239022879339*^9, 
   3.8962390234434223`*^9}, {3.8982377966099777`*^9, 3.898237819139822*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"35cfac0f-cd4e-4f7f-8777-9513f2cd3886"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"Abs", "[", "z", "]"}], "2"], "+", 
       RowBox[{"Re", "[", "z", "]"}]}], 
      RowBox[{"1", "+", "z", "+", 
       RowBox[{"Conjugate", "[", "z", "]"}], "+", 
       RowBox[{"z", " ", 
        RowBox[{"Conjugate", "[", "z", "]"}]}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "k"]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", "k"}], "k"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.896244432850075*^9, 3.896247338340571*^9, {3.896331968056242*^9, 
   3.896331974454734*^9}, 3.896332166803948*^9, 3.896332270019615*^9, 
   3.897121052691585*^9, {3.897121242108078*^9, 3.89712127599576*^9}, 
   3.897121466778698*^9, 3.897121499240345*^9, 3.8982376833227863`*^9, 
   3.898237754779488*^9, {3.898237807658545*^9, 3.898237848563445*^9}, 
   3.8982380349919357`*^9, 3.898238988471167*^9},
 CellLabel->
  "Out[259]=",ExpressionUUID->"6fea8f19-5692-4186-81db-010c4bd22f15"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.896244432850075*^9, 3.896247338340571*^9, {3.896331968056242*^9, 
   3.896331974454734*^9}, 3.896332166803948*^9, 3.896332270019615*^9, 
   3.897121052691585*^9, {3.897121242108078*^9, 3.89712127599576*^9}, 
   3.897121466778698*^9, 3.897121499240345*^9, 3.8982376833227863`*^9, 
   3.898237754779488*^9, {3.898237807658545*^9, 3.898237848563445*^9}, 
   3.8982380349919357`*^9, 3.898238988510008*^9},
 CellLabel->
  "Out[260]=",ExpressionUUID->"d8c134e5-aff4-49ed-b2ef-4d3db1cb3942"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"1", "+", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "z", " ", 
            RowBox[{"Conjugate", "[", "z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "k"}], ")"}], " ", 
            RowBox[{"Re", "[", "z", "]"}]}]}], ")"}]}]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]]}], "k"]}], ",", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "z", " ", 
            RowBox[{"Conjugate", "[", "z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "k"}], ")"}], " ", 
            RowBox[{"Re", "[", "z", "]"}]}]}], ")"}]}]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]]}], "k"]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.896244432850075*^9, 3.896247338340571*^9, {3.896331968056242*^9, 
   3.896331974454734*^9}, 3.896332166803948*^9, 3.896332270019615*^9, 
   3.897121052691585*^9, {3.897121242108078*^9, 3.89712127599576*^9}, 
   3.897121466778698*^9, 3.897121499240345*^9, 3.8982376833227863`*^9, 
   3.898237754779488*^9, {3.898237807658545*^9, 3.898237848563445*^9}, 
   3.8982380349919357`*^9, 3.898238990673296*^9},
 CellLabel->
  "Out[261]=",ExpressionUUID->"5c0cfeb5-7780-489b-b24a-a86aca85c6c6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step size control stability for RK (2, 2)", "Section",
 CellChangeTimes->{3.8982379583939962`*^9},
 FormatType->
  "TextForm",ExpressionUUID->"548cc849-e1ba-4b01-b821-69a1a4d50fdd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"t", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{"tn", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{"hn", ">", "0"}], "&&", 
    RowBox[{"tol", ">", "0"}], "&&", 
    RowBox[{"\[Eta]n", ">", "0"}], "&&", 
    RowBox[{"\[Chi]n", ">", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tn", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", "z_", "]"}], ":=", 
  RowBox[{"1", "+", "z", "+", 
   RowBox[{
    RowBox[{"z", "^", "2"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnp1", "=", 
   RowBox[{"tn", "+", "hn"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unp1", "=", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"hn", "*", "\[Lambda]"}], "]"}], "*", "un"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Quadratic", " ", "reconstruction"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"a0", "+", 
    RowBox[{"a1", "*", 
     RowBox[{"(", 
      RowBox[{"t", "-", "tn"}], ")"}]}], "+", 
    RowBox[{"a2", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Duhat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"uhat", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", "un"}], 
      "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Duhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{"\[Lambda]", "*", "un"}]}], "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tnp1"}], "}"}]}], ")"}], "\[Equal]", 
       "unp1"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"a0", ",", "a1", ",", "a2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"uhat", "//.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Duhat", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Duhat", "//.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"integrand", "=", 
  RowBox[{"FullSimplify", "@", 
   RowBox[{"Abs", "[", 
    RowBox[{"Duhat", "-", 
     RowBox[{"\[Lambda]", "*", "uhat"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQHZLy7Usl+1vHqPcpP0D0pZOqWVVAmmdNdTmI5ghh
qAHRs2Y394LoDZdfTgbR8TXCU0D0X58PQdVA2q7iaTCI1vXn5KkB0i95LflA
tI/hsYcgWuZx4WsQ/abs1kcQvWzXGzB9hLPnO4hOWbifqxZIT+FuFwbRC/wW
KINowxmmmiB6Z0EMmJYxnTavDkhbWbPOB9G3FJpOgug3U1vOgOhtk8wugmg9
Ab5LINrE1vQtiL42O/ojiK7gzmKtB9JfmWvA9JXdTZwguqxrL5i+tUGPD0Tr
LLgkDKJP/XkoD6JZQnOVQLSyTZU6iJZv0tIA0aq3Ljloc751/CV7A0xfKwut
9+F+67iuf0IjiD6yJbQbRGcYrAXTcR5psiVAusRkNpg+HzHrJohWZzsPpgH9
w7OC
  "],
 CellLabel->"In[63]:=",ExpressionUUID->"7529f318-b93d-4810-8307-2314947b5fe4"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"Abs", "[", 
   RowBox[{
    SuperscriptBox["t", "2"], " ", "un", " ", 
    SuperscriptBox["\[Lambda]", "3"]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.8962443835989447`*^9, 3.896244439256695*^9, {3.896244536680009*^9, 
   3.896244546171296*^9}, 3.8962473477187033`*^9, 3.896332279539296*^9, {
   3.896337873079482*^9, 3.896337900703074*^9}, {3.896338634093514*^9, 
   3.896338650889168*^9}, 3.897121071665886*^9, 3.897121287309132*^9, 
   3.897121517051588*^9, {3.898238041101202*^9, 3.8982380464087048`*^9}, 
   3.898238990973713*^9, {3.8983190563360243`*^9, 3.898319085377214*^9}, 
   3.898320600494686*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"aba0f85c-259d-4922-809c-e868c2e11f0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"estimateL1", "=", 
  RowBox[{"Simplify", "@", 
   RowBox[{"Integrate", "[", 
    RowBox[{"integrand", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "tn", ",", "tnp1"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.898319051017849*^9, 3.8983190529220963`*^9}, {
  3.8983191437635603`*^9, 3.898319152464246*^9}, {3.898319263830504*^9, 
  3.898319406820847*^9}, {3.898319928743186*^9, 3.898319969372471*^9}, {
  3.898320587757559*^9, 3.8983205984399233`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"2b70c4ae-0a7f-40bd-8eb5-a14734a7a371"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  SuperscriptBox["hn", "3"], " ", 
  RowBox[{"Abs", "[", 
   RowBox[{"un", " ", 
    SuperscriptBox["\[Lambda]", "3"]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.89831905325181*^9, 3.8983190580892363`*^9}, 
   3.8983190881164713`*^9, {3.8983192653709917`*^9, 3.8983192741178102`*^9}, 
   3.898319304738804*^9, {3.898319339798834*^9, 3.898319393877718*^9}, {
   3.898319947960226*^9, 3.8983199701675053`*^9}, {3.898320599483418*^9, 
   3.898320601854724*^9}},
 CellLabel->"Out[75]=",ExpressionUUID->"ca6d27e1-d012-4deb-85f8-184446b85de2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[Eta]", " ", "=", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"Abs", "[", "u", "]"}], "]"}]}], ",", " ", 
    RowBox[{"\[Chi]", " ", "=", " ", 
     RowBox[{"Log", "[", "h", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"Log", "[", 
     RowBox[{"Abs", "[", "unp1", "]"}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{"\[Eta]n", "+", 
       RowBox[{"Log", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{"Exp", "[", "\[Chi]n", "]"}], "*", "\[Lambda]"}], "]"}], 
         "]"}], "]"}]}], ",", "\[Lambda]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hnp1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"hn", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"tol", "/", "estimateL1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"\[Beta]1", "/", "k"}], ")"}]}]}], ")"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"un", " ", 
           SuperscriptBox["\[Lambda]", "3"]}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Abs", "[", "un", "]"}], "*", 
          RowBox[{
           RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "3"}]}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"un", " ", 
           SuperscriptBox["\[Lambda]", "4"]}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Abs", "[", "un", "]"}], "*", 
          RowBox[{
           RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "4"}]}]}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"\[Chi]np1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Log", "[", "hnp1", "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"hn", "\[Rule]", 
         RowBox[{"Exp", "[", "\[Chi]n", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", "un", "]"}], "\[Rule]", 
         RowBox[{"Exp", "[", "\[Eta]n", "]"}]}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.896235423525207*^9, 3.896235472803173*^9}, 
   3.8962362799480333`*^9, {3.896236485917211*^9, 3.8962366165394707`*^9}, {
   3.896236653275103*^9, 3.896236684858735*^9}, {3.896236717786442*^9, 
   3.896236896040264*^9}, {3.896236933876235*^9, 3.896237071310083*^9}, {
   3.896237108167096*^9, 3.896237162712697*^9}, {3.896237213311355*^9, 
   3.896237354910881*^9}, {3.896237385900876*^9, 3.8962375073440332`*^9}, {
   3.896237537368074*^9, 3.8962375457920017`*^9}, 3.896237582235783*^9, {
   3.896238296647077*^9, 3.896238319821246*^9}, {3.8962384914368057`*^9, 
   3.8962385045147963`*^9}, {3.8962386541803627`*^9, 3.896238823654738*^9}, {
   3.8962390158723497`*^9, 3.8962390161323957`*^9}, {3.896239203809816*^9, 
   3.8962392039132977`*^9}, {3.896239374786807*^9, 3.896239375151299*^9}, {
   3.89623941142618*^9, 3.896239520359416*^9}, {3.8962395506459703`*^9, 
   3.896239598499967*^9}, {3.8962396913423777`*^9, 3.8962396986075373`*^9}, {
   3.896244413373435*^9, 3.896244413547192*^9}, {3.896244444544767*^9, 
   3.896244445168754*^9}, {3.896244562598922*^9, 3.896244565436054*^9}, {
   3.8962446025149117`*^9, 3.896244642671073*^9}, {3.896332203075823*^9, 
   3.896332208433291*^9}, {3.896332296251605*^9, 3.896332317651187*^9}, {
   3.896332424586803*^9, 3.896332429165189*^9}, {3.896332466585815*^9, 
   3.896332522709815*^9}, {3.896332689839081*^9, 3.8963326988304*^9}, {
   3.896332848543046*^9, 3.896332857400985*^9}, {3.896332888892065*^9, 
   3.8963329307206383`*^9}, {3.8963329771155157`*^9, 3.89633297825613*^9}, {
   3.8963346370861464`*^9, 3.8963346376905527`*^9}, {3.896334679933086*^9, 
   3.896334698877077*^9}, {3.896338643273376*^9, 3.896338675860979*^9}, {
   3.8971213170364447`*^9, 3.897121317521796*^9}, {3.8971215274193277`*^9, 
   3.8971215416425867`*^9}, {3.897121745864298*^9, 3.897121752679645*^9}, {
   3.898238056377644*^9, 3.8982380744076643`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"ed28ab1d-80e0-4acb-b058-47c41d2006e5"],

Cell[BoxData[
 RowBox[{"\[Eta]n", "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Im", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Chi]n"}]], " ", 
         RowBox[{"Im", "[", "\[Lambda]", "]"}], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Chi]n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"Im", "[", "\[Lambda]", "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Re", "[", "\[Lambda]", "]"}], "2"]}], ")"}]}]}], ")"}], 
      "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.896332700659586*^9, {3.8963328500664597`*^9, 3.896332858063366*^9}, 
   3.896332931895796*^9, 3.896332979439189*^9, 3.89633463838872*^9, {
   3.896334686054207*^9, 3.896334700708474*^9}, {3.896338636031884*^9, 
   3.896338651861258*^9}, 3.897121317911386*^9, {3.897121529181332*^9, 
   3.897121542204815*^9}, {3.897121744007639*^9, 3.897121753193036*^9}, {
   3.89823806918721*^9, 3.898238075081135*^9}, 3.89823899099584*^9, 
   3.898320695606801*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"d3759aa1-0c67-485a-bf4c-fff38de5177c"],

Cell[BoxData[
 RowBox[{"Log", "[", 
  RowBox[{
   SuperscriptBox["6", 
    FractionBox["1", "k"]], " ", 
   SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Eta]n"}], "-", 
        RowBox[{"3", " ", "\[Chi]n"}]}]], " ", "tol"}], ")"}], 
    FractionBox["1", "k"]], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Lambda]", "]"}], 
    RowBox[{
     RowBox[{"-", "3"}], "/", "k"}]]}], "]"}]], "Output",
 CellChangeTimes->{
  3.896332700659586*^9, {3.8963328500664597`*^9, 3.896332858063366*^9}, 
   3.896332931895796*^9, 3.896332979439189*^9, 3.89633463838872*^9, {
   3.896334686054207*^9, 3.896334700708474*^9}, {3.896338636031884*^9, 
   3.896338651861258*^9}, 3.897121317911386*^9, {3.897121529181332*^9, 
   3.897121542204815*^9}, {3.897121744007639*^9, 3.897121753193036*^9}, {
   3.89823806918721*^9, 3.898238075081135*^9}, 3.89823899099584*^9, 
   3.8983206958317833`*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"eaa87370-ab61-4ccd-bcfc-36f31e7307f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"jacobian", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Eta]np1", ",", "\[Chi]np1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Eta]n", ",", "\[Chi]n"}], "}"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{"z", "/", 
       RowBox[{"Exp", "[", "\[Chi]n", "]"}]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"jacobian", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", " ", "+", " ", 
       RowBox[{"z", "^", "2"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", "z", " ", "+", " ", 
       RowBox[{
        RowBox[{"z", "^", "2"}], "/", "2"}]}], ")"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.896237605625327*^9, 3.8962376059263783`*^9}, {
   3.8962382371898947`*^9, 3.896238268598114*^9}, {3.896238326931666*^9, 
   3.896238350855088*^9}, 3.896238478054233*^9, {3.8962385096854362`*^9, 
   3.8962385110823517`*^9}, {3.896238842089006*^9, 3.896238844525835*^9}, {
   3.896238886801694*^9, 3.8962389184171457`*^9}, {3.896239022879339*^9, 
   3.8962390234434223`*^9}, {3.8963338497898283`*^9, 3.896333926315009*^9}, {
   3.898238126876547*^9, 3.898238171906796*^9}, {3.898320717537915*^9, 
   3.89832071769141*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"f99331e1-958a-466b-be1a-ea7ddf0e6c17"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"2", "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"Im", "[", "z", "]"}], "-", 
        RowBox[{"Re", "[", "z", "]"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
          RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"2", "+", 
        RowBox[{"Im", "[", "z", "]"}], "+", 
        RowBox[{"Re", "[", "z", "]"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
          RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "k"]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "3"}], "+", "k"}], "k"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, 3.896247353910534*^9, 3.896332217555722*^9, 
   3.896332942508497*^9, 3.8963329864224377`*^9, 3.896333864242324*^9, {
   3.896333899500824*^9, 3.8963339273967*^9}, 3.8963346447273483`*^9, 
   3.896334713393484*^9, 3.896338656624977*^9, 3.89712132837381*^9, 
   3.897121552335404*^9, 3.897121762873487*^9, {3.8982381455106907`*^9, 
   3.898238172968964*^9}, 3.8982389920297422`*^9, {3.8983206978479*^9, 
   3.89832071814357*^9}},
 CellLabel->"Out[83]=",ExpressionUUID->"419b721a-78eb-4ba0-b2c2-fd2f808551dc"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, 3.896247353910534*^9, 3.896332217555722*^9, 
   3.896332942508497*^9, 3.8963329864224377`*^9, 3.896333864242324*^9, {
   3.896333899500824*^9, 3.8963339273967*^9}, 3.8963346447273483`*^9, 
   3.896334713393484*^9, 3.896338656624977*^9, 3.89712132837381*^9, 
   3.897121552335404*^9, 3.897121762873487*^9, {3.8982381455106907`*^9, 
   3.898238172968964*^9}, 3.8982389920297422`*^9, {3.8983206978479*^9, 
   3.898320718155476*^9}},
 CellLabel->"Out[84]=",ExpressionUUID->"df97f321-48b8-4654-b230-a3a3342210f3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step size control stability for RK (3, 3) with left-biased cubic Hermite \
interpolation\
\>", "Section",
 CellChangeTimes->{
  3.898238234557571*^9, {3.89823992437928*^9, 
   3.8982399308185*^9}},ExpressionUUID->"89b88f6b-2248-40af-bf20-\
22160039d82b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"t", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{"tn", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{"hn", ">", "0"}], "&&", 
    RowBox[{"tol", ">", "0"}], "&&", 
    RowBox[{"\[Eta]n", ">", "0"}], "&&", 
    RowBox[{"\[Chi]n", ">", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tn", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", "z_", "]"}], ":=", 
  RowBox[{"1", "+", "z", "+", 
   RowBox[{
    RowBox[{"z", "^", "2"}], "/", "2"}], "+", 
   RowBox[{
    RowBox[{"z", "^", "3"}], "/", "6"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnp1", "=", 
   RowBox[{"tn", "+", "hn"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unp1", "=", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"hn", "*", "\[Lambda]"}], "]"}], "*", "un"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Left", "-", 
    RowBox[{"biased", " ", "cubic", " ", "reconstruction"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"a0", "+", 
    RowBox[{"a1", "*", 
     RowBox[{"(", 
      RowBox[{"t", "-", "tn"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"a2", "/", "2"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "^", "2"}]}], "+", 
    RowBox[{
     RowBox[{"a3", "/", "6"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "^", "3"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Duhat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"uhat", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D2uhat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"uhat", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", "un"}], 
      "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Duhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{"\[Lambda]", "*", "un"}]}], "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tnp1"}], "}"}]}], ")"}], "\[Equal]", 
       "unp1"}], "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D2uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{
        RowBox[{"\[Lambda]", "^", "2"}], "*", "un"}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Duhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tnp1"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{"\[Lambda]", "*", "unp1"}]}], "*)"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", 
      RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"uhat", "//.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Duhat", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Duhat", "//.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"integrand", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"Duhat", "-", 
     RowBox[{"\[Lambda]", "*", "uhat"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.896233895699747*^9, 3.8962339231542177`*^9}, {
   3.8962348331808863`*^9, 3.896234939864752*^9}, {3.8962349760102577`*^9, 
   3.8962351161127443`*^9}, {3.8962351673070908`*^9, 3.896235168608932*^9}, {
   3.896236695509398*^9, 3.896236703170928*^9}, {3.896238176290915*^9, 
   3.896238193782948*^9}, {3.8962398861935177`*^9, 3.8962399635589733`*^9}, {
   3.896240014827017*^9, 3.896240015397784*^9}, {3.896240060376192*^9, 
   3.896240213988451*^9}, {3.8962402842201633`*^9, 3.896240413009598*^9}, {
   3.896240457674828*^9, 3.89624045888876*^9}, {3.896243444693983*^9, 
   3.89624344816348*^9}, {3.89624378806651*^9, 3.896243812143301*^9}, {
   3.896243849705409*^9, 3.896243856439475*^9}, {3.896244073663721*^9, 
   3.896244106862773*^9}, {3.8962442673139*^9, 3.896244267875483*^9}, {
   3.896244300085428*^9, 3.896244301923152*^9}, {3.8962443374590883`*^9, 
   3.896244382582052*^9}, {3.896244479062108*^9, 3.896244499416628*^9}, {
   3.896244539819841*^9, 3.896244545328384*^9}, {3.896244751137048*^9, 
   3.896244787573018*^9}, {3.896246357082581*^9, 3.896246364347806*^9}, {
   3.896246489229727*^9, 3.896246553603753*^9}, {3.89624663747178*^9, 
   3.896246640217224*^9}, {3.896246671100582*^9, 3.896246673729004*^9}, {
   3.8962467089792423`*^9, 3.8962467293144903`*^9}, {3.896246761793852*^9, 
   3.8962467685948353`*^9}, 3.8962467994586906`*^9, {3.896246829762143*^9, 
   3.896246868537344*^9}, {3.8962469581256437`*^9, 3.896247022709507*^9}, {
   3.896249260590439*^9, 3.8962492612282143`*^9}, {3.898238226812422*^9, 
   3.8982382287630568`*^9}, {3.8982382708827553`*^9, 3.898238324452116*^9}, {
   3.898320723373118*^9, 3.8983207345962543`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"17dd9950-1e2b-4b0b-908b-3236e4e11891"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"Abs", "[", 
   RowBox[{
    SuperscriptBox["t", "3"], " ", "un", " ", 
    SuperscriptBox["\[Lambda]", "4"]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.896247023633216*^9, 3.89624735873483*^9, 3.896333011697833*^9, 
   3.89633477699401*^9, 3.8963444250986443`*^9, 3.897121818564323*^9, {
   3.898238281685852*^9, 3.89823832518118*^9}, 3.898239008181842*^9, 
   3.898320735312442*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"bee949ef-fa9f-4f18-af96-3979421ef156"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"estimateL1", "=", 
  RowBox[{"Simplify", "@", 
   RowBox[{"Integrate", "[", 
    RowBox[{"integrand", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "tn", ",", "tnp1"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.898320742146866*^9, 3.898320743202877*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"7b29c45c-6b9c-425f-a2f0-1c9d072e83d2"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "24"], " ", 
  SuperscriptBox["hn", "4"], " ", 
  RowBox[{"Abs", "[", 
   RowBox[{"un", " ", 
    SuperscriptBox["\[Lambda]", "4"]}], "]"}]}]], "Output",
 CellChangeTimes->{3.898320743928896*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"2e662429-f427-4566-850c-4c222e314c13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[Eta]", " ", "=", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"Abs", "[", "u", "]"}], "]"}]}], ",", " ", 
    RowBox[{"\[Chi]", " ", "=", " ", 
     RowBox[{"Log", "[", "h", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"Log", "[", 
     RowBox[{"Abs", "[", "unp1", "]"}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{"\[Eta]n", "+", 
       RowBox[{"Log", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{"Exp", "[", "\[Chi]n", "]"}], "*", "\[Lambda]"}], "]"}], 
         "]"}], "]"}]}], ",", "\[Lambda]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"hnp1", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"hn", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tol", "/", "estimateL1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"\[Beta]1", "/", "k"}], ")"}]}]}], ")"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"un", " ", 
         SuperscriptBox["\[Lambda]", "4"]}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"Abs", "[", "un", "]"}], "*", 
        RowBox[{
         RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "4"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Chi]np1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Log", "[", "hnp1", "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"hn", "\[Rule]", 
         RowBox[{"Exp", "[", "\[Chi]n", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", "un", "]"}], "\[Rule]", 
         RowBox[{"Exp", "[", "\[Eta]n", "]"}]}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.896235423525207*^9, 3.896235472803173*^9}, 
   3.8962362799480333`*^9, {3.896236485917211*^9, 3.8962366165394707`*^9}, {
   3.896236653275103*^9, 3.896236684858735*^9}, {3.896236717786442*^9, 
   3.896236896040264*^9}, {3.896236933876235*^9, 3.896237071310083*^9}, {
   3.896237108167096*^9, 3.896237162712697*^9}, {3.896237213311355*^9, 
   3.896237354910881*^9}, {3.896237385900876*^9, 3.8962375073440332`*^9}, {
   3.896237537368074*^9, 3.8962375457920017`*^9}, 3.896237582235783*^9, {
   3.896238296647077*^9, 3.896238319821246*^9}, {3.8962384914368057`*^9, 
   3.8962385045147963`*^9}, {3.8962386541803627`*^9, 3.896238823654738*^9}, {
   3.8962390158723497`*^9, 3.8962390161323957`*^9}, {3.896239203809816*^9, 
   3.8962392039132977`*^9}, {3.896239374786807*^9, 3.896239375151299*^9}, {
   3.89623941142618*^9, 3.896239520359416*^9}, {3.8962395506459703`*^9, 
   3.896239598499967*^9}, {3.8962396913423777`*^9, 3.8962396986075373`*^9}, {
   3.896244413373435*^9, 3.896244413547192*^9}, {3.896244444544767*^9, 
   3.896244445168754*^9}, {3.896244562598922*^9, 3.896244565436054*^9}, {
   3.8962446025149117`*^9, 3.896244642671073*^9}, {3.8962471965580463`*^9, 
   3.896247198130468*^9}, {3.896333038716322*^9, 3.896333086150125*^9}, {
   3.896334789101025*^9, 3.8963348128401823`*^9}, {3.89633507591186*^9, 
   3.8963350764848003`*^9}, {3.896344478919755*^9, 3.896344479483068*^9}, {
   3.897121951987866*^9, 3.897121979478526*^9}, 3.89712204003123*^9, {
   3.89823833513974*^9, 3.898238337760149*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"1bbce502-3e75-4247-b9d0-e06214d9fffb"],

Cell[BoxData[
 RowBox[{"\[Eta]n", "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Im", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Chi]n"}]], " ", 
         RowBox[{"Im", "[", "\[Lambda]", "]"}], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"3", " ", "\[Chi]n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"Im", "[", "\[Lambda]", "]"}], "3"]}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"Im", "[", "\[Lambda]", "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Re", "[", "\[Lambda]", "]"}], "2"]}]}], ")"}]}]}], 
       ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Chi]n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"Im", "[", "\[Lambda]", "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Re", "[", "\[Lambda]", "]"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"3", " ", "\[Chi]n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", 
            SuperscriptBox[
             RowBox[{"Im", "[", "\[Lambda]", "]"}], "2"], " ", 
            RowBox[{"Re", "[", "\[Lambda]", "]"}]}], "+", 
           SuperscriptBox[
            RowBox[{"Re", "[", "\[Lambda]", "]"}], "3"]}], ")"}]}]}], ")"}], 
      "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244445785554*^9, {3.896244547804721*^9, 
   3.896244566141745*^9}, {3.896244603191615*^9, 3.896244643067423*^9}, {
   3.896247174526602*^9, 3.896247198908383*^9}, 3.896247371831514*^9, {
   3.896333024385068*^9, 3.896333034012753*^9}, {3.8963330704895687`*^9, 
   3.896333086828116*^9}, {3.8963347861862373`*^9, 3.8963348134890757`*^9}, 
   3.896335076991173*^9, 3.896344480703114*^9, {3.897121952509986*^9, 
   3.897121981185504*^9}, 3.897122040734014*^9, 3.898238340299914*^9, 
   3.8982390081955957`*^9},
 CellLabel->
  "Out[293]=",ExpressionUUID->"c70dc5df-4e04-4a6a-9324-4ae79d1c8884"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["24", 
   FractionBox["1", "k"]], " ", "hn", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["tol", 
     SuperscriptBox["hn", "4"]], ")"}], 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", 
     RowBox[{"Abs", "[", "un", "]"}]], ")"}], 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Lambda]", "]"}], "4"]], ")"}], 
   FractionBox["1", "k"]]}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244445785554*^9, {3.896244547804721*^9, 
   3.896244566141745*^9}, {3.896244603191615*^9, 3.896244643067423*^9}, {
   3.896247174526602*^9, 3.896247198908383*^9}, 3.896247371831514*^9, {
   3.896333024385068*^9, 3.896333034012753*^9}, {3.8963330704895687`*^9, 
   3.896333086828116*^9}, {3.8963347861862373`*^9, 3.8963348134890757`*^9}, 
   3.896335076991173*^9, 3.896344480703114*^9, {3.897121952509986*^9, 
   3.897121981185504*^9}, 3.897122040734014*^9, 3.898238340299914*^9, 
   3.89823900820065*^9},
 CellLabel->
  "Out[295]=",ExpressionUUID->"cb9e831c-05f0-48d6-8543-585c9e070359"],

Cell[BoxData[
 RowBox[{"Log", "[", 
  RowBox[{
   SuperscriptBox["24", 
    FractionBox["1", "k"]], " ", 
   SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Eta]n"}], "-", 
        RowBox[{"4", " ", "\[Chi]n"}]}]], " ", "tol"}], ")"}], 
    FractionBox["1", "k"]], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Lambda]", "]"}], 
    RowBox[{
     RowBox[{"-", "4"}], "/", "k"}]]}], "]"}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244445785554*^9, {3.896244547804721*^9, 
   3.896244566141745*^9}, {3.896244603191615*^9, 3.896244643067423*^9}, {
   3.896247174526602*^9, 3.896247198908383*^9}, 3.896247371831514*^9, {
   3.896333024385068*^9, 3.896333034012753*^9}, {3.8963330704895687`*^9, 
   3.896333086828116*^9}, {3.8963347861862373`*^9, 3.8963348134890757`*^9}, 
   3.896335076991173*^9, 3.896344480703114*^9, {3.897121952509986*^9, 
   3.897121981185504*^9}, 3.897122040734014*^9, 3.898238340299914*^9, 
   3.898239008212504*^9},
 CellLabel->
  "Out[296]=",ExpressionUUID->"18b5011b-cae4-49dd-ab1b-deeee15d3802"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"jacobian", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Eta]np1", ",", "\[Chi]np1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Eta]n", ",", "\[Chi]n"}], "}"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{"z", "/", 
       RowBox[{"Exp", "[", "\[Chi]n", "]"}]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"jacobian", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], "==", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "+", 
       RowBox[{"z", "^", "2"}], "+", 
       RowBox[{
        RowBox[{"z", "^", "3"}], "/", "2"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", "z", "+", 
       RowBox[{
        RowBox[{"z", "^", "2"}], "/", "2"}], "+", 
       RowBox[{
        RowBox[{"z", "^", "3"}], "/", "6"}]}], ")"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.896237605625327*^9, 3.8962376059263783`*^9}, {
   3.8962382371898947`*^9, 3.896238268598114*^9}, {3.896238326931666*^9, 
   3.896238350855088*^9}, 3.896238478054233*^9, {3.8962385096854362`*^9, 
   3.8962385110823517`*^9}, {3.896238842089006*^9, 3.896238844525835*^9}, {
   3.896238886801694*^9, 3.8962389184171457`*^9}, {3.896239022879339*^9, 
   3.8962390234434223`*^9}, 3.896334843568632*^9, 3.89633507143746*^9, {
   3.898238354529767*^9, 3.898238416023075*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"1f247cea-3de4-4e3f-a518-4deb7981e498"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", " ", "z", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["z", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"8", "+", 
                RowBox[{"z", " ", 
                 RowBox[{"(", 
                  RowBox[{"5", "+", 
                   RowBox[{"2", " ", "z"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"12", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"18", "+", 
                RowBox[{"z", " ", 
                 RowBox[{"(", 
                  RowBox[{"12", "+", 
                   RowBox[{"5", " ", "z"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
           " ", 
           SuperscriptBox[
            RowBox[{"Sign", "[", "z", "]"}], "2"]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"12", "+", 
                RowBox[{"z", " ", 
                 RowBox[{"(", 
                  RowBox[{"9", "+", 
                   RowBox[{"4", " ", "z"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
           " ", 
           SuperscriptBox[
            RowBox[{"Sign", "[", "z", "]"}], "4"]}], "+", 
          RowBox[{"6", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", "z"}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sign", "[", "z", "]"}], "6"]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", "z"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{
           RowBox[{"Conjugate", "[", "z", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{
              RowBox[{"Conjugate", "[", "z", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", 
                RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Sign", "[", "z", "]"}], "6"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "k"]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "4"}], "+", "k"}], "k"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, {3.896247184275302*^9, 3.896247206240314*^9}, 
   3.896247379469582*^9, 3.89633309780844*^9, {3.896334806319386*^9, 
   3.896334846575783*^9}, 3.8963350802693853`*^9, 3.896344490995318*^9, {
   3.897121980759141*^9, 3.897121984073263*^9}, 3.89712204234086*^9, {
   3.898238367670312*^9, 3.8982384171989403`*^9}, 3.898239008230105*^9},
 CellLabel->
  "Out[297]=",ExpressionUUID->"80f5f497-e91d-4d04-b8ea-3216cab41a8b"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, {3.896247184275302*^9, 3.896247206240314*^9}, 
   3.896247379469582*^9, 3.89633309780844*^9, {3.896334806319386*^9, 
   3.896334846575783*^9}, 3.8963350802693853`*^9, 3.896344490995318*^9, {
   3.897121980759141*^9, 3.897121984073263*^9}, 3.89712204234086*^9, {
   3.898238367670312*^9, 3.8982384171989403`*^9}, 3.898239008239902*^9},
 CellLabel->
  "Out[298]=",ExpressionUUID->"50472a9f-364b-4fc1-897a-3afdfa8dad61"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step size control stability for RK (3, 3) with central cubic Hermite \
interpolation\
\>", "Section",
 CellChangeTimes->{
  3.898238234557571*^9, {3.89823992437928*^9, 3.898239947538622*^9}, {
   3.898321862968046*^9, 
   3.898321863117175*^9}},ExpressionUUID->"da536405-1dc7-43cd-814b-\
afdb1dae0154"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"t", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{"tn", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{"hn", ">", "0"}], "&&", 
    RowBox[{"tol", ">", "0"}], "&&", 
    RowBox[{"\[Eta]n", ">", "0"}], "&&", 
    RowBox[{"\[Chi]n", ">", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tn", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", "z_", "]"}], ":=", 
  RowBox[{"1", "+", "z", "+", 
   RowBox[{
    RowBox[{"z", "^", "2"}], "/", "2"}], "+", 
   RowBox[{
    RowBox[{"z", "^", "3"}], "/", "6"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnp1", "=", 
   RowBox[{"tn", "+", "hn"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unp1", "=", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"hn", "*", "\[Lambda]"}], "]"}], "*", "un"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Central", " ", "cubic", " ", "reconstruction"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"a0", "+", 
    RowBox[{"a1", "*", 
     RowBox[{"(", 
      RowBox[{"t", "-", "tn"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"a2", "/", "2"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "^", "2"}]}], "+", 
    RowBox[{
     RowBox[{"a3", "/", "6"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "^", "3"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Duhat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"uhat", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D2uhat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"uhat", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", "un"}], 
      "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Duhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{"\[Lambda]", "*", "un"}]}], "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tnp1"}], "}"}]}], ")"}], "\[Equal]", 
       "unp1"}], "&&", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"D2uhat", "//.", 
          RowBox[{"{", 
           RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", 
        RowBox[{
         RowBox[{"\[Lambda]", "^", "2"}], "*", "un"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Duhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tnp1"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{"\[Lambda]", "*", "unp1"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"uhat", "//.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Duhat", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Duhat", "//.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"integrand", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"Duhat", "-", 
     RowBox[{"\[Lambda]", "*", "uhat"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.896233895699747*^9, 3.8962339231542177`*^9}, {
   3.8962348331808863`*^9, 3.896234939864752*^9}, {3.8962349760102577`*^9, 
   3.8962351161127443`*^9}, {3.8962351673070908`*^9, 3.896235168608932*^9}, {
   3.896236695509398*^9, 3.896236703170928*^9}, {3.896238176290915*^9, 
   3.896238193782948*^9}, {3.8962398861935177`*^9, 3.8962399635589733`*^9}, {
   3.896240014827017*^9, 3.896240015397784*^9}, {3.896240060376192*^9, 
   3.896240213988451*^9}, {3.8962402842201633`*^9, 3.896240413009598*^9}, {
   3.896240457674828*^9, 3.89624045888876*^9}, {3.896243444693983*^9, 
   3.89624344816348*^9}, {3.89624378806651*^9, 3.896243812143301*^9}, {
   3.896243849705409*^9, 3.896243856439475*^9}, {3.896244073663721*^9, 
   3.896244106862773*^9}, {3.8962442673139*^9, 3.896244267875483*^9}, {
   3.896244300085428*^9, 3.896244301923152*^9}, {3.8962443374590883`*^9, 
   3.896244382582052*^9}, {3.896244479062108*^9, 3.896244499416628*^9}, {
   3.896244539819841*^9, 3.896244545328384*^9}, {3.896244751137048*^9, 
   3.896244787573018*^9}, {3.896246357082581*^9, 3.896246364347806*^9}, {
   3.896246489229727*^9, 3.896246553603753*^9}, {3.89624663747178*^9, 
   3.896246640217224*^9}, {3.896246671100582*^9, 3.896246673729004*^9}, {
   3.8962467089792423`*^9, 3.8962467293144903`*^9}, {3.896246761793852*^9, 
   3.8962467685948353`*^9}, 3.8962467994586906`*^9, {3.896246829762143*^9, 
   3.896246868537344*^9}, {3.8962469581256437`*^9, 3.896247022709507*^9}, {
   3.896249260590439*^9, 3.8962492612282143`*^9}, {3.898238226812422*^9, 
   3.8982382287630568`*^9}, {3.8982382708827553`*^9, 3.898238324452116*^9}, {
   3.898239954469921*^9, 3.898239990531877*^9}, {3.898240108904615*^9, 
   3.898240127801365*^9}, {3.8982415061676683`*^9, 3.898241523763535*^9}, {
   3.8983219144395857`*^9, 3.89832191846491*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"df64ed2e-3da9-4631-8755-4fb06c9b1b7a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hn", "-", "t"}], ")"}], " ", "t", " ", "un", " ", 
    SuperscriptBox["\[Lambda]", "4"], " ", 
    RowBox[{"(", 
     RowBox[{"t", "+", 
      RowBox[{"hn", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"t", " ", "\[Lambda]"}]}], ")"}]}]}], ")"}]}], 
   "]"}]}]], "Output",
 CellChangeTimes->{3.898241524601194*^9, 3.89824215666358*^9, 
  3.89832191972406*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"5074495b-6da0-4a0c-919f-5ac719f8ed60"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{743.25, 683.25},
WindowMargins->{{460.5, Automatic}, {Automatic, 20.25}},
FrontEndVersion->"12.1 for Linux x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4c022394-fc9a-491e-b337-d4002635e399"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 232, 3, 71, "Input",ExpressionUUID->"a4cac3ee-ae75-47d7-b24b-cbf38894729c",
 Evaluatable->False],
Cell[793, 25, 346, 6, 33, "Input",ExpressionUUID->"a6c14376-0133-4e47-a231-5e7ccff365dd",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[1164, 35, 315, 5, 68, "Section",ExpressionUUID->"d5e144a0-c4d1-4dbb-a41b-51d235afc8c0"],
Cell[CellGroupData[{
Cell[1504, 44, 2445, 63, 278, "Input",ExpressionUUID->"cabe4e6b-1735-443f-95cf-b185a72de295"],
Cell[3952, 109, 365, 9, 35, "Output",ExpressionUUID->"a7dc76ec-6fd7-4e21-8d27-67811412b6d4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4354, 123, 608, 16, 51, "Input",ExpressionUUID->"61b39d43-e0ce-4976-90ae-2e4896241748"],
Cell[4965, 141, 316, 8, 47, "Output",ExpressionUUID->"7ebc5861-0519-42d3-a6b5-048521ebd745"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5318, 154, 3347, 75, 135, "Input",ExpressionUUID->"48c9e826-a9a4-4159-adce-335c0f2618e8"],
Cell[8668, 231, 1392, 31, 47, "Output",ExpressionUUID->"375c9712-d0a8-4f95-a3d8-3a177e231764"],
Cell[10063, 264, 1393, 33, 56, "Output",ExpressionUUID->"636c95b4-4c0d-4204-9336-34bf9d75f639"],
Cell[11459, 299, 1392, 31, 45, "Output",ExpressionUUID->"c20f3c2a-c8db-448a-8217-d5db2387b6d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12888, 335, 1455, 36, 71, "Input",ExpressionUUID->"35cfac0f-cd4e-4f7f-8777-9513f2cd3886"],
Cell[14346, 373, 1688, 37, 53, "Output",ExpressionUUID->"6fea8f19-5692-4186-81db-010c4bd22f15"],
Cell[16037, 412, 1120, 17, 33, "Output",ExpressionUUID->"d8c134e5-aff4-49ed-b2ef-4d3db1cb3942"],
Cell[17160, 431, 3165, 83, 112, "Output",ExpressionUUID->"5c0cfeb5-7780-489b-b24a-a86aca85c6c6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20374, 520, 187, 3, 68, "Section",ExpressionUUID->"548cc849-e1ba-4b01-b821-69a1a4d50fdd"],
Cell[CellGroupData[{
Cell[20586, 527, 3630, 105, 443, "Input",ExpressionUUID->"7529f318-b93d-4810-8307-2314947b5fe4"],
Cell[24219, 634, 758, 15, 47, "Output",ExpressionUUID->"aba0f85c-259d-4922-809c-e868c2e11f0e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25014, 654, 569, 11, 29, "Input",ExpressionUUID->"2b70c4ae-0a7f-40bd-8eb5-a14734a7a371"],
Cell[25586, 667, 593, 12, 48, "Output",ExpressionUUID->"ca6d27e1-d012-4deb-85f8-184446b85de2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26216, 684, 4292, 94, 158, "Input",ExpressionUUID->"ed28ab1d-80e0-4acb-b058-47c41d2006e5"],
Cell[30511, 780, 1749, 43, 47, "Output",ExpressionUUID->"d3759aa1-0c67-485a-bf4c-fff38de5177c"],
Cell[32263, 825, 1097, 26, 45, "Output",ExpressionUUID->"eaa87370-ab61-4ccd-bcfc-36f31e7307f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33397, 856, 1577, 39, 51, "Input",ExpressionUUID->"f99331e1-958a-466b-be1a-ea7ddf0e6c17"],
Cell[34977, 897, 2500, 59, 88, "Output",ExpressionUUID->"419b721a-78eb-4ba0-b2c2-fd2f808551dc"],
Cell[37480, 958, 1235, 18, 33, "Output",ExpressionUUID->"df97f321-48b8-4654-b230-a3a3342210f3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38764, 982, 264, 7, 107, "Section",ExpressionUUID->"89b88f6b-2248-40af-bf20-22160039d82b"],
Cell[CellGroupData[{
Cell[39053, 993, 5850, 149, 504, "Input",ExpressionUUID->"17dd9950-1e2b-4b0b-908b-3236e4e11891"],
Cell[44906, 1144, 531, 12, 48, "Output",ExpressionUUID->"bee949ef-fa9f-4f18-af96-3979421ef156"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45474, 1161, 370, 8, 29, "Input",ExpressionUUID->"7b29c45c-6b9c-425f-a2f0-1c9d072e83d2"],
Cell[45847, 1171, 317, 8, 47, "Output",ExpressionUUID->"2e662429-f427-4566-850c-4c222e314c13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46201, 1184, 3551, 80, 135, "Input",ExpressionUUID->"1bbce502-3e75-4247-b9d0-e06214d9fffb"],
Cell[49755, 1266, 3060, 75, 85, "Output",ExpressionUUID->"c70dc5df-4e04-4a6a-9324-4ae79d1c8884"],
Cell[52818, 1343, 1396, 33, 56, "Output",ExpressionUUID->"cb9e831c-05f0-48d6-8543-585c9e070359"],
Cell[54217, 1378, 1398, 31, 45, "Output",ExpressionUUID->"18b5011b-cae4-49dd-ab1b-deeee15d3802"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55652, 1414, 1625, 43, 51, "Input",ExpressionUUID->"1f247cea-3de4-4e3f-a518-4deb7981e498"],
Cell[57280, 1459, 3980, 103, 121, "Output",ExpressionUUID->"80f5f497-e91d-4d04-b8ea-3216cab41a8b"],
Cell[61263, 1564, 1144, 17, 33, "Output",ExpressionUUID->"50472a9f-364b-4fc1-897a-3afdfa8dad61"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62456, 1587, 312, 8, 107, "Section",ExpressionUUID->"da536405-1dc7-43cd-814b-afdb1dae0154"],
Cell[CellGroupData[{
Cell[62793, 1599, 5963, 149, 504, "Input",ExpressionUUID->"df64ed2e-3da9-4631-8755-4fb06c9b1b7a"],
Cell[68759, 1750, 615, 19, 71, "Output",ExpressionUUID->"5074495b-6da0-4a0c-919f-5ac719f8ed60"]
}, Open  ]]
}, Open  ]]
}
]
*)

