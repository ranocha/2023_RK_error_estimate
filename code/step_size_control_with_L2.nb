(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    101979,       2550]
NotebookOptionsPosition[     96878,       2459]
NotebookOutlinePosition[     97280,       2475]
CellTagsIndexPosition[     97237,       2472]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["L2 residual error estimators", "Title"]], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.898238688581582*^9, 3.898238709167903*^9}, 
   3.898238829615073*^9},
 FormatType->"TextForm",
 CellLabel->"In[2]:=",ExpressionUUID->"93949390-163d-40a5-9382-b53bc09f540b"],

Cell[TextData[StyleBox["This notebook contains calculations for analyzing \
step size control stability with L1 residual error estimators.", "Text"]], \
"Input",
 Evaluatable->False,
 CellChangeTimes->{{3.8982386487209387`*^9, 3.8982386487229013`*^9}, {
  3.898238715562583*^9, 3.898238722395708*^9}},
 FormatType->
  "TextForm",ExpressionUUID->"f0c7dcfe-8334-4fe8-8c24-9c36b79a2164"],

Cell[CellGroupData[{

Cell["Step size control stability for explicit Euler", "Section",
 CellChangeTimes->{{3.89823586184969*^9, 3.898235862727674*^9}, {
  3.898237101313854*^9, 3.898237120600312*^9}, {3.8982387562661953`*^9, 
  3.8982387674728127`*^9}},ExpressionUUID->"917da513-78a8-49ff-902d-\
cc03bb22c74b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", 
    RowBox[{
     RowBox[{"tn", "\[GreaterEqual]", "0"}], "&&", 
     RowBox[{"hn", ">", "0"}], "&&", 
     RowBox[{"tol", ">", "0"}], "&&", 
     RowBox[{"\[Eta]n", ">", "0"}], "&&", 
     RowBox[{"\[Chi]n", ">", "0"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnp1", "=", 
   RowBox[{"tn", "+", "hn"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", "z_", "]"}], ":=", 
  RowBox[{"1", "+", "z"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unp1", "=", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"hn", "*", "\[Lambda]"}], "]"}], "*", "un"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Linear", " ", "reconstruction"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"un", "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"tnp1", "-", "tn"}], ")"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"unp1", "-", "un"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"Duhat", "=", 
    RowBox[{"D", "[", 
     RowBox[{"uhat", ",", "t"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"estimateL2", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Sqrt", "[", "hn", "]"}], "*", 
     RowBox[{"Simplify", "@", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Duhat", "-", 
            RowBox[{"\[Lambda]", "*", "uhat"}]}], "]"}], "^", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tn", ",", "tnp1"}], "}"}]}], "]"}], "]"}]}]}], 
    "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"un", "*", 
      RowBox[{"Conjugate", "[", "un", "]"}]}], "\[Rule]", 
     RowBox[{
      RowBox[{"Abs", "[", "un", "]"}], "^", "2"}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.896233895699747*^9, 3.8962339231542177`*^9}, {
   3.8962348331808863`*^9, 3.896234939864752*^9}, {3.8962349760102577`*^9, 
   3.8962351161127443`*^9}, {3.8962351673070908`*^9, 3.896235168608932*^9}, {
   3.896236695509398*^9, 3.896236703170928*^9}, {3.896238176290915*^9, 
   3.896238193782948*^9}, {3.896244421426671*^9, 3.8962444263608007`*^9}, {
   3.897121151210969*^9, 3.8971212058990602`*^9}, {3.898237137970739*^9, 
   3.8982371383362627`*^9}, {3.898237481019886*^9, 3.898237482419362*^9}, {
   3.898237574122312*^9, 3.898237574786117*^9}, {3.8982376437833843`*^9, 
   3.8982376512627163`*^9}, {3.8982379800633583`*^9, 3.898238015881113*^9}, 
   3.898239097556831*^9, 3.8982391520856543`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"5a0c886b-9e15-463f-ac87-b14f1e013541"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["hn", "2"], " ", 
   RowBox[{"Abs", "[", "un", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Lambda]", "]"}], "2"]}], 
  SqrtBox["3"]]], "Output",
 CellChangeTimes->{3.898238019741047*^9, 3.898238988011077*^9, 
  3.898239100333167*^9, 3.898239153595573*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"afb3b10a-c5a5-4fab-9d0e-befcedf5044d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[Eta]", " ", "=", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"Abs", "[", "u", "]"}], "]"}]}], ",", " ", 
    RowBox[{"\[Chi]", " ", "=", " ", 
     RowBox[{"Log", "[", "h", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"Log", "[", 
     RowBox[{"Abs", "[", "unp1", "]"}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{"\[Eta]n", "+", 
       RowBox[{"Log", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{"Exp", "[", "\[Chi]n", "]"}], "*", "\[Lambda]"}], "]"}], 
         "]"}], "]"}]}], ",", "\[Lambda]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"hnp1", "=", 
    RowBox[{"hn", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"tol", "/", "estimateL2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"\[Beta]1", "/", "k"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"\[Chi]np1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Log", "[", "hnp1", "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "un", "]"}], "\[Rule]", 
         RowBox[{"Exp", "[", "\[Eta]n", "]"}]}], ",", 
        RowBox[{"hn", "\[Rule]", 
         RowBox[{"Exp", "[", "\[Chi]n", "]"}]}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.896235423525207*^9, 3.896235472803173*^9}, 
   3.8962362799480333`*^9, {3.896236485917211*^9, 3.8962366165394707`*^9}, {
   3.896236653275103*^9, 3.896236684858735*^9}, {3.896236717786442*^9, 
   3.896236896040264*^9}, {3.896236933876235*^9, 3.896237071310083*^9}, {
   3.896237108167096*^9, 3.896237162712697*^9}, {3.896237213311355*^9, 
   3.896237354910881*^9}, {3.896237385900876*^9, 3.8962375073440332`*^9}, {
   3.896237537368074*^9, 3.8962375457920017`*^9}, 3.896237582235783*^9, {
   3.896238296647077*^9, 3.896238319821246*^9}, {3.8962384914368057`*^9, 
   3.8962385045147963`*^9}, {3.8962386541803627`*^9, 3.896238823654738*^9}, {
   3.8962390158723497`*^9, 3.8962390161323957`*^9}, {3.896239203809816*^9, 
   3.8962392039132977`*^9}, {3.896239374786807*^9, 3.896239375151299*^9}, {
   3.89623941142618*^9, 3.896239520359416*^9}, {3.8962395506459703`*^9, 
   3.896239598499967*^9}, {3.8962396913423777`*^9, 3.8962396986075373`*^9}, {
   3.896244418036598*^9, 3.8962444186737537`*^9}, {3.8963319714572487`*^9, 
   3.896331972140767*^9}, {3.89633210013013*^9, 3.896332163356917*^9}, {
   3.896332265740583*^9, 3.896332266712929*^9}, {3.8971212356219893`*^9, 
   3.897121273074278*^9}, {3.897121372181244*^9, 3.8971213905237617`*^9}, {
   3.897121438427998*^9, 3.897121450695888*^9}, {3.897121487868581*^9, 
   3.897121488455649*^9}, {3.898237602029159*^9, 3.8982376249426203`*^9}, {
   3.898237840265954*^9, 3.8982378589347343`*^9}, 3.898239111531217*^9, 
   3.8982391515343323`*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"65f38416-f4be-4ec4-94cc-aa16e40a8d87"],

Cell[BoxData[
 RowBox[{"\[Eta]n", "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[Chi]n"}]], " ", 
      SuperscriptBox[
       RowBox[{"Im", "[", "\[Lambda]", "]"}], "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}]}], ")"}], "2"]}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244429655254*^9, 3.8962473342342663`*^9, {
   3.896331965688078*^9, 3.896331972859754*^9}, {3.896332100749403*^9, 
   3.896332163853244*^9}, 3.896332267813305*^9, 3.897121047690755*^9, {
   3.897121236370434*^9, 3.897121273709721*^9}, {3.8971213688453703`*^9, 
   3.897121391033291*^9}, {3.897121422905861*^9, 3.897121489043169*^9}, {
   3.898237605082697*^9, 3.898237625917707*^9}, 3.898237656664256*^9, 
   3.898237769506495*^9, 3.898237846018979*^9, 3.89823802623549*^9, 
   3.898238988145718*^9, 3.8982391126839113`*^9, 3.8982391598503532`*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"fbd2a9e7-1737-4367-99fb-1d5e65e10149"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["3", 
   RowBox[{
    FractionBox["1", "2"], "/", "k"}]], " ", "hn", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["tol", 
     SuperscriptBox["hn", "2"]], ")"}], 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", 
     RowBox[{"Abs", "[", "un", "]"}]], ")"}], 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Lambda]", "]"}], "2"]], ")"}], 
   FractionBox["1", "k"]]}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244429655254*^9, 3.8962473342342663`*^9, {
   3.896331965688078*^9, 3.896331972859754*^9}, {3.896332100749403*^9, 
   3.896332163853244*^9}, 3.896332267813305*^9, 3.897121047690755*^9, {
   3.897121236370434*^9, 3.897121273709721*^9}, {3.8971213688453703`*^9, 
   3.897121391033291*^9}, {3.897121422905861*^9, 3.897121489043169*^9}, {
   3.898237605082697*^9, 3.898237625917707*^9}, 3.898237656664256*^9, 
   3.898237769506495*^9, 3.898237846018979*^9, 3.89823802623549*^9, 
   3.898238988145718*^9, 3.8982391126839113`*^9, 3.898239159851372*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"c33435f2-494a-4b87-b707-aa86d0d47c83"],

Cell[BoxData[
 RowBox[{"Log", "[", 
  RowBox[{
   SuperscriptBox["3", 
    RowBox[{
     FractionBox["1", "2"], "/", "k"}]], " ", 
   SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Eta]n"}], "-", 
        RowBox[{"2", " ", "\[Chi]n"}]}]], " ", "tol"}], ")"}], 
    FractionBox["1", "k"]], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Lambda]", "]"}], 
    RowBox[{
     RowBox[{"-", "2"}], "/", "k"}]]}], "]"}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244429655254*^9, 3.8962473342342663`*^9, {
   3.896331965688078*^9, 3.896331972859754*^9}, {3.896332100749403*^9, 
   3.896332163853244*^9}, 3.896332267813305*^9, 3.897121047690755*^9, {
   3.897121236370434*^9, 3.897121273709721*^9}, {3.8971213688453703`*^9, 
   3.897121391033291*^9}, {3.897121422905861*^9, 3.897121489043169*^9}, {
   3.898237605082697*^9, 3.898237625917707*^9}, 3.898237656664256*^9, 
   3.898237769506495*^9, 3.898237846018979*^9, 3.89823802623549*^9, 
   3.898238988145718*^9, 3.8982391126839113`*^9, 3.8982391600516367`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"e0e96772-d14a-4878-8ccf-5c7794f2d4ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"jacobian", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Eta]np1", ",", "\[Chi]np1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Eta]n", ",", "\[Chi]n"}], "}"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{"z", "/", 
       RowBox[{"Exp", "[", "\[Chi]n", "]"}]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"jacobian", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", 
   RowBox[{"Re", "[", 
    RowBox[{"z", "/", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", "z"}], " ", ")"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ev", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Eigenvalues", "[", "jacobian", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.896237605625327*^9, 3.8962376059263783`*^9}, {
   3.8962382371898947`*^9, 3.896238268598114*^9}, {3.896238326931666*^9, 
   3.896238350855088*^9}, 3.896238478054233*^9, {3.8962385096854362`*^9, 
   3.8962385110823517`*^9}, {3.896238842089006*^9, 3.896238844525835*^9}, {
   3.896238886801694*^9, 3.8962389184171457`*^9}, {3.896239022879339*^9, 
   3.8962390234434223`*^9}, {3.8982377966099777`*^9, 3.898237819139822*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"50d6252f-a1a6-46b3-becb-275b35009274"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"Abs", "[", "z", "]"}], "2"], "+", 
       RowBox[{"Re", "[", "z", "]"}]}], 
      RowBox[{"1", "+", "z", "+", 
       RowBox[{"Conjugate", "[", "z", "]"}], "+", 
       RowBox[{"z", " ", 
        RowBox[{"Conjugate", "[", "z", "]"}]}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "k"]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", "k"}], "k"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.896244432850075*^9, 3.896247338340571*^9, {3.896331968056242*^9, 
   3.896331974454734*^9}, 3.896332166803948*^9, 3.896332270019615*^9, 
   3.897121052691585*^9, {3.897121242108078*^9, 3.89712127599576*^9}, 
   3.897121466778698*^9, 3.897121499240345*^9, 3.8982376833227863`*^9, 
   3.898237754779488*^9, {3.898237807658545*^9, 3.898237848563445*^9}, 
   3.8982380349919357`*^9, 3.898238988471167*^9, 3.898239127785528*^9, 
   3.8982391625474997`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"70e79761-878a-47ee-8ff7-f427c5da2b86"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.896244432850075*^9, 3.896247338340571*^9, {3.896331968056242*^9, 
   3.896331974454734*^9}, 3.896332166803948*^9, 3.896332270019615*^9, 
   3.897121052691585*^9, {3.897121242108078*^9, 3.89712127599576*^9}, 
   3.897121466778698*^9, 3.897121499240345*^9, 3.8982376833227863`*^9, 
   3.898237754779488*^9, {3.898237807658545*^9, 3.898237848563445*^9}, 
   3.8982380349919357`*^9, 3.898238988471167*^9, 3.898239127785528*^9, 
   3.8982391625818157`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"16c7f253-60de-4beb-936e-04b303ffb634"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"1", "+", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "z", " ", 
            RowBox[{"Conjugate", "[", "z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "k"}], ")"}], " ", 
            RowBox[{"Re", "[", "z", "]"}]}]}], ")"}]}]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]]}], "k"]}], ",", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "z", " ", 
            RowBox[{"Conjugate", "[", "z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "k"}], ")"}], " ", 
            RowBox[{"Re", "[", "z", "]"}]}]}], ")"}]}]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]]}], "k"]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.896244432850075*^9, 3.896247338340571*^9, {3.896331968056242*^9, 
   3.896331974454734*^9}, 3.896332166803948*^9, 3.896332270019615*^9, 
   3.897121052691585*^9, {3.897121242108078*^9, 3.89712127599576*^9}, 
   3.897121466778698*^9, 3.897121499240345*^9, 3.8982376833227863`*^9, 
   3.898237754779488*^9, {3.898237807658545*^9, 3.898237848563445*^9}, 
   3.8982380349919357`*^9, 3.898238988471167*^9, 3.898239127785528*^9, 
   3.898239164623465*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"f3b1075c-212e-4e94-85a6-ecae27ee71f0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step size control stability for RK (2, 2)", "Section",
 CellChangeTimes->{3.898239215811823*^9},
 FormatType->
  "TextForm",ExpressionUUID->"952d3201-0e2e-4f47-82c8-15c4f127e839"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", 
    RowBox[{
     RowBox[{"t", "\[GreaterEqual]", "0"}], "&&", 
     RowBox[{"tn", "\[GreaterEqual]", "0"}], "&&", 
     RowBox[{"hn", ">", "0"}], "&&", 
     RowBox[{"tol", ">", "0"}], "&&", 
     RowBox[{"\[Eta]n", ">", "0"}], "&&", 
     RowBox[{"\[Chi]n", ">", "0"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", "z_", "]"}], ":=", 
  RowBox[{"1", "+", "z", "+", 
   RowBox[{
    RowBox[{"z", "^", "2"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnp1", "=", 
   RowBox[{"tn", "+", "hn"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unp1", "=", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"hn", "*", "\[Lambda]"}], "]"}], "*", "un"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Quadratic", " ", "reconstruction"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"a0", "+", 
    RowBox[{"a1", "*", 
     RowBox[{"(", 
      RowBox[{"t", "-", "tn"}], ")"}]}], "+", 
    RowBox[{"a2", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Duhat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"uhat", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", "un"}], 
      "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Duhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{"\[Lambda]", "*", "un"}]}], "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tnp1"}], "}"}]}], ")"}], "\[Equal]", 
       "unp1"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"a0", ",", "a1", ",", "a2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"uhat", "//.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Duhat", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Duhat", "//.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"estimateL2", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Sqrt", "[", "hn", "]"}], "*", 
    RowBox[{"Simplify", "@", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Duhat", "-", 
           RowBox[{"\[Lambda]", "*", "uhat"}]}], "]"}], "^", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "tn", ",", "tnp1"}], "}"}]}], "]"}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQHZLy7Usl+1vHqPcpP0D0pZOqWVVAmmdNdTmI5ghh
qAHRs2Y394LoDZdfTgbR8TXCU0D0X58PQdVA2q7iaTCI1vXn5KkB0i95LflA
tI/hsYcgWuZx4WsQ/abs1kcQvWzXGzB9hLPnO4hOWbifqxZIT+FuFwbRC/wW
KINowxmmmiB6Z0EMmJYxnTavDkhbWbPOB9G3FJpOgug3U1vOgOhtk8wugmg9
Ab5LINrE1vQtiL42O/ojiK7gzmKtB9JfmWvA9JXdTZwguqxrL5i+tUGPD0Tr
LLgkDKJP/XkoD6JZQnOVQLSyTZU6iJZv0tIA0aq3Ljloc751/CV7A0wH7fSQ
9eV+69gaX6oAogEvPJ0e
  "],
 CellLabel->"In[33]:=",ExpressionUUID->"87cf1e48-381a-43f7-8701-7fa6f6dba4a6"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["hn", "3"], " ", 
   RowBox[{"Abs", "[", 
    RowBox[{"un", " ", 
     SuperscriptBox["\[Lambda]", "3"]}], "]"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["5"]}]]], "Output",
 CellChangeTimes->{
  3.8962443835989447`*^9, 3.896244439256695*^9, {3.896244536680009*^9, 
   3.896244546171296*^9}, 3.8962473477187033`*^9, 3.896332279539296*^9, {
   3.896337873079482*^9, 3.896337900703074*^9}, {3.896338634093514*^9, 
   3.896338650889168*^9}, 3.897121071665886*^9, 3.897121287309132*^9, 
   3.897121517051588*^9, 3.897122612788089*^9, 3.898239237382225*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"3ff17701-7d46-4725-9a3d-2bc65cad3b67"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[Eta]", " ", "=", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"Abs", "[", "u", "]"}], "]"}]}], ",", " ", 
    RowBox[{"\[Chi]", " ", "=", " ", 
     RowBox[{"Log", "[", "h", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"Log", "[", 
     RowBox[{"Abs", "[", "unp1", "]"}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{"\[Eta]n", "+", 
       RowBox[{"Log", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{"Exp", "[", "\[Chi]n", "]"}], "*", "\[Lambda]"}], "]"}], 
         "]"}], "]"}]}], ",", "\[Lambda]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hnp1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"hn", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"tol", "/", "estimateL2"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"\[Beta]1", "/", "k"}], ")"}]}]}], ")"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"un", " ", 
           SuperscriptBox["\[Lambda]", "3"]}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Abs", "[", "un", "]"}], "*", 
          RowBox[{
           RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "3"}]}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"un", " ", 
           SuperscriptBox["\[Lambda]", "4"]}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Abs", "[", "un", "]"}], "*", 
          RowBox[{
           RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "4"}]}]}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"\[Chi]np1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Log", "[", "hnp1", "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"hn", "\[Rule]", 
         RowBox[{"Exp", "[", "\[Chi]n", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", "un", "]"}], "\[Rule]", 
         RowBox[{"Exp", "[", "\[Eta]n", "]"}]}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.896235423525207*^9, 3.896235472803173*^9}, 
   3.8962362799480333`*^9, {3.896236485917211*^9, 3.8962366165394707`*^9}, {
   3.896236653275103*^9, 3.896236684858735*^9}, {3.896236717786442*^9, 
   3.896236896040264*^9}, {3.896236933876235*^9, 3.896237071310083*^9}, {
   3.896237108167096*^9, 3.896237162712697*^9}, {3.896237213311355*^9, 
   3.896237354910881*^9}, {3.896237385900876*^9, 3.8962375073440332`*^9}, {
   3.896237537368074*^9, 3.8962375457920017`*^9}, 3.896237582235783*^9, {
   3.896238296647077*^9, 3.896238319821246*^9}, {3.8962384914368057`*^9, 
   3.8962385045147963`*^9}, {3.8962386541803627`*^9, 3.896238823654738*^9}, {
   3.8962390158723497`*^9, 3.8962390161323957`*^9}, {3.896239203809816*^9, 
   3.8962392039132977`*^9}, {3.896239374786807*^9, 3.896239375151299*^9}, {
   3.89623941142618*^9, 3.896239520359416*^9}, {3.8962395506459703`*^9, 
   3.896239598499967*^9}, {3.8962396913423777`*^9, 3.8962396986075373`*^9}, {
   3.896244413373435*^9, 3.896244413547192*^9}, {3.896244444544767*^9, 
   3.896244445168754*^9}, {3.896244562598922*^9, 3.896244565436054*^9}, {
   3.8962446025149117`*^9, 3.896244642671073*^9}, {3.896332203075823*^9, 
   3.896332208433291*^9}, {3.896332296251605*^9, 3.896332317651187*^9}, {
   3.896332424586803*^9, 3.896332429165189*^9}, {3.896332466585815*^9, 
   3.896332522709815*^9}, {3.896332689839081*^9, 3.8963326988304*^9}, {
   3.896332848543046*^9, 3.896332857400985*^9}, {3.896332888892065*^9, 
   3.8963329307206383`*^9}, {3.8963329771155157`*^9, 3.89633297825613*^9}, {
   3.8963346370861464`*^9, 3.8963346376905527`*^9}, {3.896334679933086*^9, 
   3.896334698877077*^9}, {3.896338643273376*^9, 3.896338675860979*^9}, {
   3.8971213170364447`*^9, 3.897121317521796*^9}, {3.8971215274193277`*^9, 
   3.8971215416425867`*^9}, {3.897121745864298*^9, 3.897121752679645*^9}, {
   3.898239252115004*^9, 3.8982392556286907`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"7f061fac-3a7f-4395-9b7a-1ce9dd132807"],

Cell[BoxData[
 RowBox[{"\[Eta]n", "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Im", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Chi]n"}]], " ", 
         RowBox[{"Im", "[", "\[Lambda]", "]"}], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Chi]n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"Im", "[", "\[Lambda]", "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Re", "[", "\[Lambda]", "]"}], "2"]}], ")"}]}]}], ")"}], 
      "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.896332700659586*^9, {3.8963328500664597`*^9, 3.896332858063366*^9}, 
   3.896332931895796*^9, 3.896332979439189*^9, 3.89633463838872*^9, {
   3.896334686054207*^9, 3.896334700708474*^9}, {3.896338636031884*^9, 
   3.896338651861258*^9}, 3.897121317911386*^9, {3.897121529181332*^9, 
   3.897121542204815*^9}, {3.897121744007639*^9, 3.897121753193036*^9}, 
   3.897122617075592*^9, 3.898239256942049*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"87efcf9c-008b-4b1c-9b87-6838389db808"],

Cell[BoxData[
 RowBox[{"Log", "[", 
  RowBox[{
   SuperscriptBox["2", 
    FractionBox["1", "k"]], " ", 
   SuperscriptBox["5", 
    RowBox[{
     FractionBox["1", "2"], "/", "k"}]], " ", 
   SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Eta]n"}], "-", 
        RowBox[{"3", " ", "\[Chi]n"}]}]], " ", "tol"}], ")"}], 
    FractionBox["1", "k"]], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Lambda]", "]"}], 
    RowBox[{
     RowBox[{"-", "3"}], "/", "k"}]]}], "]"}]], "Output",
 CellChangeTimes->{
  3.896332700659586*^9, {3.8963328500664597`*^9, 3.896332858063366*^9}, 
   3.896332931895796*^9, 3.896332979439189*^9, 3.89633463838872*^9, {
   3.896334686054207*^9, 3.896334700708474*^9}, {3.896338636031884*^9, 
   3.896338651861258*^9}, 3.897121317911386*^9, {3.897121529181332*^9, 
   3.897121542204815*^9}, {3.897121744007639*^9, 3.897121753193036*^9}, 
   3.897122617075592*^9, 3.8982392571927643`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"d87fc325-d612-4b80-9484-f69d12903152"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"jacobian", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Eta]np1", ",", "\[Chi]np1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Eta]n", ",", "\[Chi]n"}], "}"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{"z", "/", 
       RowBox[{"Exp", "[", "\[Chi]n", "]"}]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"jacobian", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], "==", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", " ", "+", " ", 
       RowBox[{"z", "^", "2"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", "z", " ", "+", " ", 
       RowBox[{
        RowBox[{"z", "^", "2"}], "/", "2"}]}], ")"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ev", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Eigenvalues", "[", "jacobian", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.896237605625327*^9, 3.8962376059263783`*^9}, {
   3.8962382371898947`*^9, 3.896238268598114*^9}, {3.896238326931666*^9, 
   3.896238350855088*^9}, 3.896238478054233*^9, {3.8962385096854362`*^9, 
   3.8962385110823517`*^9}, {3.896238842089006*^9, 3.896238844525835*^9}, {
   3.896238886801694*^9, 3.8962389184171457`*^9}, {3.896239022879339*^9, 
   3.8962390234434223`*^9}, {3.8963338497898283`*^9, 3.896333926315009*^9}, {
   3.8982392719919653`*^9, 3.898239303831758*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"a27b90c3-2a3f-4168-a377-68380e58b6c7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"2", "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"Im", "[", "z", "]"}], "-", 
        RowBox[{"Re", "[", "z", "]"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
          RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"2", "+", 
        RowBox[{"Im", "[", "z", "]"}], "+", 
        RowBox[{"Re", "[", "z", "]"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
          RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "k"]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "3"}], "+", "k"}], "k"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, 3.896247353910534*^9, 3.896332217555722*^9, 
   3.896332942508497*^9, 3.8963329864224377`*^9, 3.896333864242324*^9, {
   3.896333899500824*^9, 3.8963339273967*^9}, 3.8963346447273483`*^9, 
   3.896334713393484*^9, 3.896338656624977*^9, 3.89712132837381*^9, 
   3.897121552335404*^9, 3.897121762873487*^9, 3.897122620126457*^9, {
   3.8982392845725594`*^9, 3.898239306607801*^9}},
 CellLabel->"Out[50]=",ExpressionUUID->"90b1a9da-3daf-4bbc-bc31-f1495f5cd48a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, 3.896247353910534*^9, 3.896332217555722*^9, 
   3.896332942508497*^9, 3.8963329864224377`*^9, 3.896333864242324*^9, {
   3.896333899500824*^9, 3.8963339273967*^9}, 3.8963346447273483`*^9, 
   3.896334713393484*^9, 3.896338656624977*^9, 3.89712132837381*^9, 
   3.897121552335404*^9, 3.897121762873487*^9, 3.897122620126457*^9, {
   3.8982392845725594`*^9, 3.898239306690497*^9}},
 CellLabel->"Out[51]=",ExpressionUUID->"7c06173e-9d16-42d0-81f0-1f143c82253a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "-", 
    FractionBox["3", 
     RowBox[{"2", " ", "k"}]], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"z", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", "z"}], ")"}]}]}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{
            RowBox[{"Conjugate", "[", "z", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "36"}], "+", 
           RowBox[{"18", " ", 
            SuperscriptBox["z", "2"]}], "-", 
           RowBox[{"8", " ", "k", " ", 
            SuperscriptBox["z", "2"]}], "+", 
           RowBox[{"6", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", 
              RowBox[{"2", " ", "k"}]}], ")"}], " ", "z", " ", 
            SuperscriptBox[
             RowBox[{"Abs", "[", "z", "]"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "9"}], " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 RowBox[{"z", " ", 
                  RowBox[{"(", 
                   RowBox[{"2", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"4", " ", "k", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 RowBox[{"z", " ", 
                  RowBox[{"(", 
                   RowBox[{"3", "+", 
                    RowBox[{"2", " ", "z"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
            " ", 
            SuperscriptBox[
             RowBox[{"Conjugate", "[", "z", "]"}], "2"]}], "+", 
           RowBox[{"8", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "9"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "z"}], ")"}]}], "+", 
              RowBox[{"k", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 RowBox[{"4", " ", "z"}]}], ")"}]}]}], ")"}], " ", 
            RowBox[{"Re", "[", "z", "]"}]}]}], ")"}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"z", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "z"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"Conjugate", "[", "z", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]}], ")"}]}], 
      ")"}]}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"2", "-", 
      FractionBox["3", "k"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"z", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", "z"}], ")"}]}]}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{
              RowBox[{"Conjugate", "[", "z", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", 
                RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "36"}], "+", 
             RowBox[{"18", " ", 
              SuperscriptBox["z", "2"]}], "-", 
             RowBox[{"8", " ", "k", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{"6", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"2", " ", "k"}]}], ")"}], " ", "z", " ", 
              SuperscriptBox[
               RowBox[{"Abs", "[", "z", "]"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "9"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", 
                   RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"4", " ", "k", " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", 
                   RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{"2", " ", "z"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
              " ", 
              SuperscriptBox[
               RowBox[{"Conjugate", "[", "z", "]"}], "2"]}], "+", 
             RowBox[{"8", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "9"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "z"}], ")"}]}], "+", 
                RowBox[{"k", " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", 
                   RowBox[{"4", " ", "z"}]}], ")"}]}]}], ")"}], " ", 
              RowBox[{"Re", "[", "z", "]"}]}]}], ")"}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"k", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "z"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{
            RowBox[{"Conjugate", "[", "z", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]}], ")"}]}], 
        ")"}]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, 3.896247353910534*^9, 3.896332217555722*^9, 
   3.896332942508497*^9, 3.8963329864224377`*^9, 3.896333864242324*^9, {
   3.896333899500824*^9, 3.8963339273967*^9}, 3.8963346447273483`*^9, 
   3.896334713393484*^9, 3.896338656624977*^9, 3.89712132837381*^9, 
   3.897121552335404*^9, 3.897121762873487*^9, 3.897122620126457*^9, {
   3.8982392845725594`*^9, 3.8982393067084427`*^9}},
 CellLabel->"Out[52]=",ExpressionUUID->"27a6d6a5-eb1e-4c55-b07d-b1b937430f23"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step size control stability for RK (3, 3) with left-biased cubic Hermite \
interpolation\
\>", "Section",
 CellChangeTimes->{
  3.8982393352049637`*^9, {3.8982394352975407`*^9, 3.898239444888962*^9}},
 FormatType->
  "TextForm",ExpressionUUID->"4c4b678e-a184-4b9c-8eed-09fa12da6550"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"t", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{"tn", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{"hn", ">", "0"}], "&&", 
    RowBox[{"tol", ">", "0"}], "&&", 
    RowBox[{"\[Eta]n", ">", "0"}], "&&", 
    RowBox[{"\[Chi]n", ">", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tn", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", "z_", "]"}], ":=", 
  RowBox[{"1", "+", "z", "+", 
   RowBox[{
    RowBox[{"z", "^", "2"}], "/", "2"}], "+", 
   RowBox[{
    RowBox[{"z", "^", "3"}], "/", "6"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnp1", "=", 
   RowBox[{"tn", "+", "hn"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unp1", "=", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"hn", "*", "\[Lambda]"}], "]"}], "*", "un"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Left", "-", 
    RowBox[{"biased", " ", "cubic", " ", "reconstruction"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"a0", "+", 
    RowBox[{"a1", "*", 
     RowBox[{"(", 
      RowBox[{"t", "-", "tn"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"a2", "/", "2"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "^", "2"}]}], "+", 
    RowBox[{
     RowBox[{"a3", "/", "6"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "^", "3"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Duhat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"uhat", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D2uhat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"uhat", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", "un"}], 
      "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Duhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{"\[Lambda]", "*", "un"}]}], "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tnp1"}], "}"}]}], ")"}], "\[Equal]", 
       "unp1"}], "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D2uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{
        RowBox[{"\[Lambda]", "^", "2"}], "*", "un"}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Duhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tnp1"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{"\[Lambda]", "*", "unp1"}]}], "*)"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", 
      RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"uhat", "//.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Duhat", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Duhat", "//.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"estimateL2", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Sqrt", "[", "hn", "]"}], "*", 
     RowBox[{"Simplify", "@", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Duhat", "-", 
            RowBox[{"\[Lambda]", "*", "uhat"}]}], "]"}], "^", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tn", ",", "tnp1"}], "}"}]}], "]"}]}]}]}], "]"}], 
   "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "*", 
      RowBox[{"Conjugate", "[", "\[Lambda]", "]"}]}], "->", 
     RowBox[{
      RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "2"}]}], 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.896233895699747*^9, 3.8962339231542177`*^9}, {
   3.8962348331808863`*^9, 3.896234939864752*^9}, {3.8962349760102577`*^9, 
   3.8962351161127443`*^9}, {3.8962351673070908`*^9, 3.896235168608932*^9}, {
   3.896236695509398*^9, 3.896236703170928*^9}, {3.896238176290915*^9, 
   3.896238193782948*^9}, {3.8962398861935177`*^9, 3.8962399635589733`*^9}, {
   3.896240014827017*^9, 3.896240015397784*^9}, {3.896240060376192*^9, 
   3.896240213988451*^9}, {3.8962402842201633`*^9, 3.896240413009598*^9}, {
   3.896240457674828*^9, 3.89624045888876*^9}, {3.896243444693983*^9, 
   3.89624344816348*^9}, {3.89624378806651*^9, 3.896243812143301*^9}, {
   3.896243849705409*^9, 3.896243856439475*^9}, {3.896244073663721*^9, 
   3.896244106862773*^9}, {3.8962442673139*^9, 3.896244267875483*^9}, {
   3.896244300085428*^9, 3.896244301923152*^9}, {3.8962443374590883`*^9, 
   3.896244382582052*^9}, {3.896244479062108*^9, 3.896244499416628*^9}, {
   3.896244539819841*^9, 3.896244545328384*^9}, {3.896244751137048*^9, 
   3.896244787573018*^9}, {3.896246357082581*^9, 3.896246364347806*^9}, {
   3.896246489229727*^9, 3.896246553603753*^9}, {3.89624663747178*^9, 
   3.896246640217224*^9}, {3.896246671100582*^9, 3.896246673729004*^9}, {
   3.8962467089792423`*^9, 3.8962467293144903`*^9}, {3.896246761793852*^9, 
   3.8962467685948353`*^9}, 3.8962467994586906`*^9, {3.896246829762143*^9, 
   3.896246868537344*^9}, {3.8962469581256437`*^9, 3.896247022709507*^9}, {
   3.896249260590439*^9, 3.8962492612282143`*^9}, {3.897122658125696*^9, 
   3.897122664824442*^9}, {3.89823932978469*^9, 3.89823936343946*^9}, {
   3.898239449037311*^9, 3.898239477034709*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"8732a03f-15e3-4fc9-aced-27116b68e420"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["hn", "4"], " ", 
   RowBox[{"Abs", "[", 
    RowBox[{"un", " ", 
     SuperscriptBox["\[Lambda]", "4"]}], "]"}]}], 
  RowBox[{"6", " ", 
   SqrtBox["7"]}]]], "Output",
 CellChangeTimes->{
  3.896247023633216*^9, 3.89624735873483*^9, 3.896333011697833*^9, 
   3.89633477699401*^9, 3.8963444250986443`*^9, 3.897121818564323*^9, {
   3.897122641680533*^9, 3.897122665277769*^9}, 3.89712401235043*^9, 
   3.898239366607679*^9, {3.8982394552314*^9, 3.898239479371334*^9}},
 CellLabel->"Out[99]=",ExpressionUUID->"e4d8feae-b840-4359-99f7-bbc6a9e963d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[Eta]", " ", "=", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"Abs", "[", "u", "]"}], "]"}]}], ",", " ", 
    RowBox[{"\[Chi]", " ", "=", " ", 
     RowBox[{"Log", "[", "h", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"Log", "[", 
     RowBox[{"Abs", "[", "unp1", "]"}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{"\[Eta]n", "+", 
       RowBox[{"Log", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{"Exp", "[", "\[Chi]n", "]"}], "*", "\[Lambda]"}], "]"}], 
         "]"}], "]"}]}], ",", "\[Lambda]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"hnp1", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"hn", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tol", "/", "estimateL2"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"\[Beta]1", "/", "k"}], ")"}]}]}], ")"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"un", " ", 
         SuperscriptBox["\[Lambda]", "4"]}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"Abs", "[", "un", "]"}], "*", 
        RowBox[{
         RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "4"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Chi]np1", "=", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Log", "[", "hnp1", "]"}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hn", "\[Rule]", 
          RowBox[{"Exp", "[", "\[Chi]n", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Abs", "[", "un", "]"}], "\[Rule]", 
          RowBox[{"Exp", "[", "\[Eta]n", "]"}]}]}], "}"}]}], "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "*", 
        RowBox[{"Conjugate", "[", "\[Lambda]", "]"}]}], "->", 
       RowBox[{
        RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "2"}]}], 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.896235423525207*^9, 3.896235472803173*^9}, 
   3.8962362799480333`*^9, {3.896236485917211*^9, 3.8962366165394707`*^9}, {
   3.896236653275103*^9, 3.896236684858735*^9}, {3.896236717786442*^9, 
   3.896236896040264*^9}, {3.896236933876235*^9, 3.896237071310083*^9}, {
   3.896237108167096*^9, 3.896237162712697*^9}, {3.896237213311355*^9, 
   3.896237354910881*^9}, {3.896237385900876*^9, 3.8962375073440332`*^9}, {
   3.896237537368074*^9, 3.8962375457920017`*^9}, 3.896237582235783*^9, {
   3.896238296647077*^9, 3.896238319821246*^9}, {3.8962384914368057`*^9, 
   3.8962385045147963`*^9}, {3.8962386541803627`*^9, 3.896238823654738*^9}, {
   3.8962390158723497`*^9, 3.8962390161323957`*^9}, {3.896239203809816*^9, 
   3.8962392039132977`*^9}, {3.896239374786807*^9, 3.896239375151299*^9}, {
   3.89623941142618*^9, 3.896239520359416*^9}, {3.8962395506459703`*^9, 
   3.896239598499967*^9}, {3.8962396913423777`*^9, 3.8962396986075373`*^9}, {
   3.896244413373435*^9, 3.896244413547192*^9}, {3.896244444544767*^9, 
   3.896244445168754*^9}, {3.896244562598922*^9, 3.896244565436054*^9}, {
   3.8962446025149117`*^9, 3.896244642671073*^9}, {3.8962471965580463`*^9, 
   3.896247198130468*^9}, {3.896333038716322*^9, 3.896333086150125*^9}, {
   3.896334789101025*^9, 3.8963348128401823`*^9}, {3.89633507591186*^9, 
   3.8963350764848003`*^9}, {3.896344478919755*^9, 3.896344479483068*^9}, {
   3.897121951987866*^9, 3.897121979478526*^9}, 3.89712204003123*^9, {
   3.897122745038703*^9, 3.897122753510839*^9}, {3.898239463532998*^9, 
   3.898239464572095*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"ff854974-4528-4a1c-8f57-ea9a46a9b67d"],

Cell[BoxData[
 RowBox[{"\[Eta]n", "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Im", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Chi]n"}]], " ", 
         RowBox[{"Im", "[", "\[Lambda]", "]"}], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"3", " ", "\[Chi]n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"Im", "[", "\[Lambda]", "]"}], "3"]}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"Im", "[", "\[Lambda]", "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Re", "[", "\[Lambda]", "]"}], "2"]}]}], ")"}]}]}], 
       ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Chi]n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"Im", "[", "\[Lambda]", "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Re", "[", "\[Lambda]", "]"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"3", " ", "\[Chi]n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", 
            SuperscriptBox[
             RowBox[{"Im", "[", "\[Lambda]", "]"}], "2"], " ", 
            RowBox[{"Re", "[", "\[Lambda]", "]"}]}], "+", 
           SuperscriptBox[
            RowBox[{"Re", "[", "\[Lambda]", "]"}], "3"]}], ")"}]}]}], ")"}], 
      "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244445785554*^9, {3.896244547804721*^9, 
   3.896244566141745*^9}, {3.896244603191615*^9, 3.896244643067423*^9}, {
   3.896247174526602*^9, 3.896247198908383*^9}, 3.896247371831514*^9, {
   3.896333024385068*^9, 3.896333034012753*^9}, {3.8963330704895687`*^9, 
   3.896333086828116*^9}, {3.8963347861862373`*^9, 3.8963348134890757`*^9}, 
   3.896335076991173*^9, 3.896344480703114*^9, {3.897121952509986*^9, 
   3.897121981185504*^9}, 3.897122040734014*^9, {3.897122741711886*^9, 
   3.897122754836673*^9}, {3.897123994962346*^9, 3.897124017926659*^9}, {
   3.898239461561082*^9, 3.898239480648582*^9}},
 CellLabel->
  "Out[100]=",ExpressionUUID->"43d1648b-6d56-49bb-9c6e-4c10aa5c2c75"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["6", 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox["7", 
   RowBox[{
    FractionBox["1", "2"], "/", "k"}]], " ", "hn", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["tol", 
     SuperscriptBox["hn", "4"]], ")"}], 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", 
     RowBox[{"Abs", "[", "un", "]"}]], ")"}], 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Lambda]", "]"}], "4"]], ")"}], 
   FractionBox["1", "k"]]}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244445785554*^9, {3.896244547804721*^9, 
   3.896244566141745*^9}, {3.896244603191615*^9, 3.896244643067423*^9}, {
   3.896247174526602*^9, 3.896247198908383*^9}, 3.896247371831514*^9, {
   3.896333024385068*^9, 3.896333034012753*^9}, {3.8963330704895687`*^9, 
   3.896333086828116*^9}, {3.8963347861862373`*^9, 3.8963348134890757`*^9}, 
   3.896335076991173*^9, 3.896344480703114*^9, {3.897121952509986*^9, 
   3.897121981185504*^9}, 3.897122040734014*^9, {3.897122741711886*^9, 
   3.897122754836673*^9}, {3.897123994962346*^9, 3.897124017926659*^9}, {
   3.898239461561082*^9, 3.8982394806577177`*^9}},
 CellLabel->
  "Out[102]=",ExpressionUUID->"63b2980d-c660-4d04-94aa-c44bcf7f618e"],

Cell[BoxData[
 RowBox[{"Log", "[", 
  RowBox[{
   SuperscriptBox["6", 
    FractionBox["1", "k"]], " ", 
   SuperscriptBox["7", 
    RowBox[{
     FractionBox["1", "2"], "/", "k"}]], " ", 
   SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Eta]n"}], "-", 
        RowBox[{"4", " ", "\[Chi]n"}]}]], " ", "tol"}], ")"}], 
    FractionBox["1", "k"]], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Lambda]", "]"}], 
    RowBox[{
     RowBox[{"-", "4"}], "/", "k"}]]}], "]"}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244445785554*^9, {3.896244547804721*^9, 
   3.896244566141745*^9}, {3.896244603191615*^9, 3.896244643067423*^9}, {
   3.896247174526602*^9, 3.896247198908383*^9}, 3.896247371831514*^9, {
   3.896333024385068*^9, 3.896333034012753*^9}, {3.8963330704895687`*^9, 
   3.896333086828116*^9}, {3.8963347861862373`*^9, 3.8963348134890757`*^9}, 
   3.896335076991173*^9, 3.896344480703114*^9, {3.897121952509986*^9, 
   3.897121981185504*^9}, 3.897122040734014*^9, {3.897122741711886*^9, 
   3.897122754836673*^9}, {3.897123994962346*^9, 3.897124017926659*^9}, {
   3.898239461561082*^9, 3.898239480658901*^9}},
 CellLabel->
  "Out[103]=",ExpressionUUID->"167cfe8b-970a-4dbf-b7de-a851dd6bf4b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"jacobian", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Eta]np1", ",", "\[Chi]np1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Eta]n", ",", "\[Chi]n"}], "}"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{"z", "/", 
       RowBox[{"Exp", "[", "\[Chi]n", "]"}]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"jacobian", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "+", 
       RowBox[{"z", "^", "2"}], "+", 
       RowBox[{
        RowBox[{"z", "^", "3"}], "/", "2"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", "z", "+", 
       RowBox[{
        RowBox[{"z", "^", "2"}], "/", "2"}], "+", 
       RowBox[{
        RowBox[{"z", "^", "3"}], "/", "6"}]}], ")"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.896237605625327*^9, 3.8962376059263783`*^9}, {
   3.8962382371898947`*^9, 3.896238268598114*^9}, {3.896238326931666*^9, 
   3.896238350855088*^9}, 3.896238478054233*^9, {3.8962385096854362`*^9, 
   3.8962385110823517`*^9}, {3.896238842089006*^9, 3.896238844525835*^9}, {
   3.896238886801694*^9, 3.8962389184171457`*^9}, {3.896239022879339*^9, 
   3.8962390234434223`*^9}, 3.896334843568632*^9, 3.89633507143746*^9, {
   3.898239485806046*^9, 3.898239513457057*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"68e92d6f-9a74-425d-8ae5-136feffabd88"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", " ", "z", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["z", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"8", "+", 
                RowBox[{"z", " ", 
                 RowBox[{"(", 
                  RowBox[{"5", "+", 
                   RowBox[{"2", " ", "z"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"12", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"18", "+", 
                RowBox[{"z", " ", 
                 RowBox[{"(", 
                  RowBox[{"12", "+", 
                   RowBox[{"5", " ", "z"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
           " ", 
           SuperscriptBox[
            RowBox[{"Sign", "[", "z", "]"}], "2"]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"12", "+", 
                RowBox[{"z", " ", 
                 RowBox[{"(", 
                  RowBox[{"9", "+", 
                   RowBox[{"4", " ", "z"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
           " ", 
           SuperscriptBox[
            RowBox[{"Sign", "[", "z", "]"}], "4"]}], "+", 
          RowBox[{"6", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", "z"}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sign", "[", "z", "]"}], "6"]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", "z"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{
           RowBox[{"Conjugate", "[", "z", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{
              RowBox[{"Conjugate", "[", "z", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", 
                RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Sign", "[", "z", "]"}], "6"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "k"]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "4"}], "+", "k"}], "k"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, {3.896247184275302*^9, 3.896247206240314*^9}, 
   3.896247379469582*^9, 3.89633309780844*^9, {3.896334806319386*^9, 
   3.896334846575783*^9}, 3.8963350802693853`*^9, 3.896344490995318*^9, {
   3.897121980759141*^9, 3.897121984073263*^9}, 3.89712204234086*^9, 
   3.897122764044942*^9, {3.897124002500947*^9, 3.897124023048011*^9}, {
   3.898239498266821*^9, 3.898239514560454*^9}},
 CellLabel->
  "Out[105]=",ExpressionUUID->"aad7dc11-55fb-4b8f-959d-97a5be7c5d9c"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, {3.896247184275302*^9, 3.896247206240314*^9}, 
   3.896247379469582*^9, 3.89633309780844*^9, {3.896334806319386*^9, 
   3.896334846575783*^9}, 3.8963350802693853`*^9, 3.896344490995318*^9, {
   3.897121980759141*^9, 3.897121984073263*^9}, 3.89712204234086*^9, 
   3.897122764044942*^9, {3.897124002500947*^9, 3.897124023048011*^9}, {
   3.898239498266821*^9, 3.89823951465582*^9}},
 CellLabel->
  "Out[106]=",ExpressionUUID->"788ce44a-5912-49bd-8cb1-b5dc972b4217"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step size control stability for RK (3, 3) with central cubic Hermite \
interpolation\
\>", "Section",
 CellChangeTimes->{{3.8982395543283463`*^9, 3.898239574247666*^9}},
 FormatType->
  "TextForm",ExpressionUUID->"63908919-2cbe-40db-b630-057c70bcd2f0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"t", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{"tn", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{"hn", ">", "0"}], "&&", 
    RowBox[{"tol", ">", "0"}], "&&", 
    RowBox[{"\[Eta]n", ">", "0"}], "&&", 
    RowBox[{"\[Chi]n", ">", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tn", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", "z_", "]"}], ":=", 
  RowBox[{"1", "+", "z", "+", 
   RowBox[{
    RowBox[{"z", "^", "2"}], "/", "2"}], "+", 
   RowBox[{
    RowBox[{"z", "^", "3"}], "/", "6"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnp1", "=", 
   RowBox[{"tn", "+", "hn"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unp1", "=", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"hn", "*", "\[Lambda]"}], "]"}], "*", "un"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Central", " ", "cubic", " ", "reconstruction"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"a0", "+", 
    RowBox[{"a1", "*", 
     RowBox[{"(", 
      RowBox[{"t", "-", "tn"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"a2", "/", "2"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "^", "2"}]}], "+", 
    RowBox[{
     RowBox[{"a3", "/", "6"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", "tn"}], ")"}], "^", "3"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Duhat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"uhat", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D2uhat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"uhat", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", "un"}], 
      "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Duhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{"\[Lambda]", "*", "un"}]}], "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tnp1"}], "}"}]}], ")"}], "\[Equal]", 
       "unp1"}], "&&", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"D2uhat", "//.", 
          RowBox[{"{", 
           RowBox[{"t", "\[Rule]", "tn"}], "}"}]}], ")"}], "\[Equal]", 
        RowBox[{
         RowBox[{"\[Lambda]", "^", "2"}], "*", "un"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Duhat", "//.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "tnp1"}], "}"}]}], ")"}], "\[Equal]", 
       RowBox[{"\[Lambda]", "*", "unp1"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhat", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"uhat", "//.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Duhat", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Duhat", "//.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"estimateL2", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Sqrt", "[", "hn", "]"}], "*", 
     RowBox[{"Simplify", "@", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Duhat", "-", 
            RowBox[{"\[Lambda]", "*", "uhat"}]}], "]"}], "^", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tn", ",", "tnp1"}], "}"}]}], "]"}]}]}]}], "]"}], 
   "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "*", 
      RowBox[{"Conjugate", "[", "\[Lambda]", "]"}]}], "->", 
     RowBox[{
      RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "2"}]}], 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.896233895699747*^9, 3.8962339231542177`*^9}, {
   3.8962348331808863`*^9, 3.896234939864752*^9}, {3.8962349760102577`*^9, 
   3.8962351161127443`*^9}, {3.8962351673070908`*^9, 3.896235168608932*^9}, {
   3.896236695509398*^9, 3.896236703170928*^9}, {3.896238176290915*^9, 
   3.896238193782948*^9}, {3.8962398861935177`*^9, 3.8962399635589733`*^9}, {
   3.896240014827017*^9, 3.896240015397784*^9}, {3.896240060376192*^9, 
   3.896240213988451*^9}, {3.8962402842201633`*^9, 3.896240413009598*^9}, {
   3.896240457674828*^9, 3.89624045888876*^9}, {3.896243444693983*^9, 
   3.89624344816348*^9}, {3.89624378806651*^9, 3.896243812143301*^9}, {
   3.896243849705409*^9, 3.896243856439475*^9}, {3.896244073663721*^9, 
   3.896244106862773*^9}, {3.8962442673139*^9, 3.896244267875483*^9}, {
   3.896244300085428*^9, 3.896244301923152*^9}, {3.8962443374590883`*^9, 
   3.896244382582052*^9}, {3.896244479062108*^9, 3.896244499416628*^9}, {
   3.896244539819841*^9, 3.896244545328384*^9}, {3.896244751137048*^9, 
   3.896244787573018*^9}, {3.896246357082581*^9, 3.896246364347806*^9}, {
   3.896246489229727*^9, 3.896246553603753*^9}, {3.89624663747178*^9, 
   3.896246640217224*^9}, {3.896246671100582*^9, 3.896246673729004*^9}, {
   3.8962467089792423`*^9, 3.8962467293144903`*^9}, {3.896246761793852*^9, 
   3.8962467685948353`*^9}, 3.8962467994586906`*^9, {3.896246829762143*^9, 
   3.896246868537344*^9}, {3.8962469581256437`*^9, 3.896247022709507*^9}, {
   3.896249260590439*^9, 3.8962492612282143`*^9}, {3.897122658125696*^9, 
   3.897122664824442*^9}, {3.897123613289073*^9, 3.897123620915594*^9}, {
   3.898239548411364*^9, 3.898239597100276*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"22a85354-a3d2-497f-933f-510617297273"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["hn", "4"], " ", 
   RowBox[{"Abs", "[", "un", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Lambda]", "]"}], "4"], " ", 
   SqrtBox[
    RowBox[{"8", "+", 
     RowBox[{
      SuperscriptBox["hn", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[Lambda]", "]"}], "2"]}], "-", 
     RowBox[{"5", " ", "hn", " ", 
      RowBox[{"Re", "[", "\[Lambda]", "]"}]}]}]]}], 
  RowBox[{"6", " ", 
   SqrtBox["105"]}]]], "Output",
 CellChangeTimes->{
  3.896247023633216*^9, 3.89624735873483*^9, 3.896333011697833*^9, 
   3.89633477699401*^9, 3.8963444250986443`*^9, 3.897121818564323*^9, {
   3.897122641680533*^9, 3.897122665277769*^9}, 3.8971236215987186`*^9, {
   3.898239590205141*^9, 3.898239599767468*^9}},
 CellLabel->
  "Out[132]=",ExpressionUUID->"bd681340-6a19-4872-9aa3-4e1e13379a19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[Eta]", " ", "=", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"Abs", "[", "u", "]"}], "]"}]}], ",", " ", 
    RowBox[{"\[Chi]", " ", "=", " ", 
     RowBox[{"Log", "[", "h", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"Log", "[", 
     RowBox[{"Abs", "[", "unp1", "]"}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Eta]np1", "=", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{"\[Eta]n", "+", 
       RowBox[{"Log", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{"Exp", "[", "\[Chi]n", "]"}], "*", "\[Lambda]"}], "]"}], 
         "]"}], "]"}]}], ",", "\[Lambda]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"hnp1", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"hn", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tol", "/", "estimateL2"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"\[Beta]1", "/", "k"}], ")"}]}]}], ")"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"un", " ", 
         SuperscriptBox["\[Lambda]", "4"]}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"Abs", "[", "un", "]"}], "*", 
        RowBox[{
         RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "4"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Chi]np1", "=", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Log", "[", "hnp1", "]"}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hn", "\[Rule]", 
          RowBox[{"Exp", "[", "\[Chi]n", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Abs", "[", "un", "]"}], "\[Rule]", 
          RowBox[{"Exp", "[", "\[Eta]n", "]"}]}]}], "}"}]}], "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "*", 
        RowBox[{"Conjugate", "[", "\[Lambda]", "]"}]}], "->", 
       RowBox[{
        RowBox[{"Abs", "[", "\[Lambda]", "]"}], "^", "2"}]}], 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.896235423525207*^9, 3.896235472803173*^9}, 
   3.8962362799480333`*^9, {3.896236485917211*^9, 3.8962366165394707`*^9}, {
   3.896236653275103*^9, 3.896236684858735*^9}, {3.896236717786442*^9, 
   3.896236896040264*^9}, {3.896236933876235*^9, 3.896237071310083*^9}, {
   3.896237108167096*^9, 3.896237162712697*^9}, {3.896237213311355*^9, 
   3.896237354910881*^9}, {3.896237385900876*^9, 3.8962375073440332`*^9}, {
   3.896237537368074*^9, 3.8962375457920017`*^9}, 3.896237582235783*^9, {
   3.896238296647077*^9, 3.896238319821246*^9}, {3.8962384914368057`*^9, 
   3.8962385045147963`*^9}, {3.8962386541803627`*^9, 3.896238823654738*^9}, {
   3.8962390158723497`*^9, 3.8962390161323957`*^9}, {3.896239203809816*^9, 
   3.8962392039132977`*^9}, {3.896239374786807*^9, 3.896239375151299*^9}, {
   3.89623941142618*^9, 3.896239520359416*^9}, {3.8962395506459703`*^9, 
   3.896239598499967*^9}, {3.8962396913423777`*^9, 3.8962396986075373`*^9}, {
   3.896244413373435*^9, 3.896244413547192*^9}, {3.896244444544767*^9, 
   3.896244445168754*^9}, {3.896244562598922*^9, 3.896244565436054*^9}, {
   3.8962446025149117`*^9, 3.896244642671073*^9}, {3.8962471965580463`*^9, 
   3.896247198130468*^9}, {3.896333038716322*^9, 3.896333086150125*^9}, {
   3.896334789101025*^9, 3.8963348128401823`*^9}, {3.89633507591186*^9, 
   3.8963350764848003`*^9}, {3.896344478919755*^9, 3.896344479483068*^9}, {
   3.897121951987866*^9, 3.897121979478526*^9}, 3.89712204003123*^9, {
   3.897122745038703*^9, 3.897122753510839*^9}, {3.8982396402749577`*^9, 
   3.898239641711903*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"78582c36-93c8-4b6d-a0b8-3f4c3b2a1d94"],

Cell[BoxData[
 RowBox[{"\[Eta]n", "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Im", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Chi]n"}]], " ", 
         RowBox[{"Im", "[", "\[Lambda]", "]"}], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"3", " ", "\[Chi]n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"Im", "[", "\[Lambda]", "]"}], "3"]}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"Im", "[", "\[Lambda]", "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Re", "[", "\[Lambda]", "]"}], "2"]}]}], ")"}]}]}], 
       ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Chi]n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"Im", "[", "\[Lambda]", "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Re", "[", "\[Lambda]", "]"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"3", " ", "\[Chi]n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", 
            SuperscriptBox[
             RowBox[{"Im", "[", "\[Lambda]", "]"}], "2"], " ", 
            RowBox[{"Re", "[", "\[Lambda]", "]"}]}], "+", 
           SuperscriptBox[
            RowBox[{"Re", "[", "\[Lambda]", "]"}], "3"]}], ")"}]}]}], ")"}], 
      "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244445785554*^9, {3.896244547804721*^9, 
   3.896244566141745*^9}, {3.896244603191615*^9, 3.896244643067423*^9}, {
   3.896247174526602*^9, 3.896247198908383*^9}, 3.896247371831514*^9, {
   3.896333024385068*^9, 3.896333034012753*^9}, {3.8963330704895687`*^9, 
   3.896333086828116*^9}, {3.8963347861862373`*^9, 3.8963348134890757`*^9}, 
   3.896335076991173*^9, 3.896344480703114*^9, {3.897121952509986*^9, 
   3.897121981185504*^9}, 3.897122040734014*^9, {3.897122741711886*^9, 
   3.897122754836673*^9}, 3.898239643104315*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"8d9ea770-c24f-4a91-b03a-822d711eaf2a"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["2", 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox["3", 
   RowBox[{
    FractionBox["3", "2"], "/", "k"}]], " ", 
  SuperscriptBox["35", 
   RowBox[{
    FractionBox["1", "2"], "/", "k"}]], " ", "hn", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", 
     RowBox[{"Abs", "[", "un", "]"}]], ")"}], 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Lambda]", "]"}], "4"]], ")"}], 
   FractionBox["1", "k"]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["tol", 
     RowBox[{
      SuperscriptBox["hn", "4"], " ", 
      SqrtBox[
       RowBox[{"8", "+", 
        RowBox[{
         SuperscriptBox["hn", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Abs", "[", "\[Lambda]", "]"}], "2"]}], "-", 
        RowBox[{"5", " ", "hn", " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}]}]]}]], ")"}], 
   FractionBox["1", "k"]]}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244445785554*^9, {3.896244547804721*^9, 
   3.896244566141745*^9}, {3.896244603191615*^9, 3.896244643067423*^9}, {
   3.896247174526602*^9, 3.896247198908383*^9}, 3.896247371831514*^9, {
   3.896333024385068*^9, 3.896333034012753*^9}, {3.8963330704895687`*^9, 
   3.896333086828116*^9}, {3.8963347861862373`*^9, 3.8963348134890757`*^9}, 
   3.896335076991173*^9, 3.896344480703114*^9, {3.897121952509986*^9, 
   3.897121981185504*^9}, 3.897122040734014*^9, {3.897122741711886*^9, 
   3.897122754836673*^9}, 3.898239643110134*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"22a91aa1-c802-4b78-8312-e612933a6a38"],

Cell[BoxData[
 RowBox[{"Log", "[", 
  RowBox[{
   SuperscriptBox["6", 
    RowBox[{
     FractionBox["3", "2"], "/", "k"}]], " ", 
   SuperscriptBox["35", 
    RowBox[{
     FractionBox["1", "2"], "/", "k"}]], " ", 
   SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Lambda]", "]"}], 
    RowBox[{
     RowBox[{"-", "4"}], "/", "k"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[Eta]n"}], "-", 
         RowBox[{"4", " ", "\[Chi]n"}]}]], " ", "tol"}], 
      SqrtBox[
       RowBox[{"16", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Chi]n"}]], " ", 
         SuperscriptBox[
          RowBox[{"Abs", "[", "\[Lambda]", "]"}], "2"]}], "-", 
        RowBox[{"10", " ", 
         SuperscriptBox["\[ExponentialE]", "\[Chi]n"], " ", 
         RowBox[{"Re", "[", "\[Lambda]", "]"}]}]}]]], ")"}], 
    FractionBox["1", "k"]]}], "]"}]], "Output",
 CellChangeTimes->{
  3.896238773018753*^9, {3.896238816466099*^9, 3.8962388241314163`*^9}, 
   3.896239205554035*^9, 3.896239376366417*^9, {3.896239413027996*^9, 
   3.896239521961776*^9}, {3.89623955433783*^9, 3.896239599087987*^9}, 
   3.8962398024261007`*^9, 3.896244445785554*^9, {3.896244547804721*^9, 
   3.896244566141745*^9}, {3.896244603191615*^9, 3.896244643067423*^9}, {
   3.896247174526602*^9, 3.896247198908383*^9}, 3.896247371831514*^9, {
   3.896333024385068*^9, 3.896333034012753*^9}, {3.8963330704895687`*^9, 
   3.896333086828116*^9}, {3.8963347861862373`*^9, 3.8963348134890757`*^9}, 
   3.896335076991173*^9, 3.896344480703114*^9, {3.897121952509986*^9, 
   3.897121981185504*^9}, 3.897122040734014*^9, {3.897122741711886*^9, 
   3.897122754836673*^9}, 3.89823964650797*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"00ff69d8-f6e4-43f2-bc4b-4c82d07b5356"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"jacobian", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Eta]np1", ",", "\[Chi]np1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Eta]n", ",", "\[Chi]n"}], "}"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{"z", "/", 
       RowBox[{"Exp", "[", "\[Chi]n", "]"}]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"jacobian", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], "==", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "+", 
       RowBox[{"z", "^", "2"}], "+", 
       RowBox[{
        RowBox[{"z", "^", "3"}], "/", "2"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", "z", "+", 
       RowBox[{
        RowBox[{"z", "^", "2"}], "/", "2"}], "+", 
       RowBox[{
        RowBox[{"z", "^", "3"}], "/", "6"}]}], ")"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"jacobian", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}], "\[Equal]", 
   RowBox[{"1", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"64", "+", 
       RowBox[{"10", "*", 
        RowBox[{
         RowBox[{"Abs", "[", "z", "]"}], "^", "2"}]}], "-", 
       RowBox[{"45", "*", 
        RowBox[{"Re", "[", "z", "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "k", "*", 
       RowBox[{"(", 
        RowBox[{"8", "+", 
         RowBox[{
          RowBox[{"Abs", "[", "z", "]"}], "^", "2"}], "-", 
         RowBox[{"5", "*", 
          RowBox[{"Re", "[", "z", "]"}]}]}], ")"}]}], ")"}]}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.896237605625327*^9, 3.8962376059263783`*^9}, {
   3.8962382371898947`*^9, 3.896238268598114*^9}, {3.896238326931666*^9, 
   3.896238350855088*^9}, 3.896238478054233*^9, {3.8962385096854362`*^9, 
   3.8962385110823517`*^9}, {3.896238842089006*^9, 3.896238844525835*^9}, {
   3.896238886801694*^9, 3.8962389184171457`*^9}, {3.896239022879339*^9, 
   3.8962390234434223`*^9}, 3.896334843568632*^9, 3.89633507143746*^9, {
   3.898239650088913*^9, 3.898239729806609*^9}, {3.898239777624826*^9, 
   3.8982397789980583`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"ff90f6a1-9292-4536-a5b9-d2b02dae63cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", " ", "z", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["z", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"8", "+", 
                RowBox[{"z", " ", 
                 RowBox[{"(", 
                  RowBox[{"5", "+", 
                   RowBox[{"2", " ", "z"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"12", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"18", "+", 
                RowBox[{"z", " ", 
                 RowBox[{"(", 
                  RowBox[{"12", "+", 
                   RowBox[{"5", " ", "z"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
           " ", 
           SuperscriptBox[
            RowBox[{"Sign", "[", "z", "]"}], "2"]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"12", "+", 
                RowBox[{"z", " ", 
                 RowBox[{"(", 
                  RowBox[{"9", "+", 
                   RowBox[{"4", " ", "z"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
           " ", 
           SuperscriptBox[
            RowBox[{"Sign", "[", "z", "]"}], "4"]}], "+", 
          RowBox[{"6", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", "z"}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sign", "[", "z", "]"}], "6"]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"z", " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", "z"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{
           RowBox[{"Conjugate", "[", "z", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{
              RowBox[{"Conjugate", "[", "z", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", 
                RowBox[{"Conjugate", "[", "z", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Sign", "[", "z", "]"}], "6"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "k"]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"16", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "k"}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", "k"}], ")"}], " ", "z", " ", 
        RowBox[{"Conjugate", "[", "z", "]"}]}], "+", 
       RowBox[{"5", " ", 
        RowBox[{"(", 
         RowBox[{"9", "-", 
          RowBox[{"2", " ", "k"}]}], ")"}], " ", 
        RowBox[{"Re", "[", "z", "]"}]}]}], 
      RowBox[{"2", " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{"8", "+", 
         SuperscriptBox[
          RowBox[{"Abs", "[", "z", "]"}], "2"], "-", 
         RowBox[{"5", " ", 
          RowBox[{"Re", "[", "z", "]"}]}]}], ")"}]}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, {3.896247184275302*^9, 3.896247206240314*^9}, 
   3.896247379469582*^9, 3.89633309780844*^9, {3.896334806319386*^9, 
   3.896334846575783*^9}, 3.8963350802693853`*^9, 3.896344490995318*^9, {
   3.897121980759141*^9, 3.897121984073263*^9}, 3.89712204234086*^9, 
   3.897122764044942*^9, 3.8982396788778267`*^9, 3.8982397317223988`*^9, 
   3.8982397799839287`*^9},
 CellLabel->
  "Out[142]=",ExpressionUUID->"d63ffe8d-f33e-4cb3-b139-98dc979adcc3"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, {3.896247184275302*^9, 3.896247206240314*^9}, 
   3.896247379469582*^9, 3.89633309780844*^9, {3.896334806319386*^9, 
   3.896334846575783*^9}, 3.8963350802693853`*^9, 3.896344490995318*^9, {
   3.897121980759141*^9, 3.897121984073263*^9}, 3.89712204234086*^9, 
   3.897122764044942*^9, 3.8982396788778267`*^9, 3.8982397317223988`*^9, 
   3.898239779996291*^9},
 CellLabel->
  "Out[143]=",ExpressionUUID->"7bc98d5f-d4b8-4c4a-a7b2-c914a888aa74"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.896237409435502*^9, {3.89623756856131*^9, 3.896237585280381*^9}, 
   3.896238151852129*^9, {3.8962381990414*^9, 3.896238238867505*^9}, 
   3.896238269128378*^9, {3.8962383465327883`*^9, 3.896238351851513*^9}, 
   3.896238478673884*^9, 3.896238511399913*^9, {3.8962388339667253`*^9, 
   3.8962388449610977`*^9}, {3.896238896131452*^9, 3.8962389189351*^9}, 
   3.896239023929001*^9, 3.89623920690407*^9, 3.896239377813717*^9, 
   3.896239414677497*^9, {3.896239451890749*^9, 3.8962395238573008`*^9}, {
   3.896239555829776*^9, 3.8962396004053307`*^9}, 3.8962398024433527`*^9, 
   3.89624445047369*^9, 3.896244570288059*^9, {3.896244606093409*^9, 
   3.896244644955516*^9}, {3.896247184275302*^9, 3.896247206240314*^9}, 
   3.896247379469582*^9, 3.89633309780844*^9, {3.896334806319386*^9, 
   3.896334846575783*^9}, 3.8963350802693853`*^9, 3.896344490995318*^9, {
   3.897121980759141*^9, 3.897121984073263*^9}, 3.89712204234086*^9, 
   3.897122764044942*^9, 3.8982396788778267`*^9, 3.8982397317223988`*^9, 
   3.89823978002792*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"b8a51f3f-4f32-471d-866a-472814ba3b2d"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{726.75, 683.25},
WindowMargins->{{465.75, Automatic}, {162, Automatic}},
FrontEndVersion->"12.1 for Linux x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4c022394-fc9a-491e-b337-d4002635e399"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 290, 5, 71, "Input",ExpressionUUID->"93949390-163d-40a5-9382-b53bc09f540b",
 Evaluatable->False],
Cell[851, 27, 384, 7, 56, "Input",ExpressionUUID->"f0c7dcfe-8334-4fe8-8c24-9c36b79a2164",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[1260, 38, 289, 4, 68, "Section",ExpressionUUID->"917da513-78a8-49ff-902d-cc03bb22c74b"],
Cell[CellGroupData[{
Cell[1574, 46, 2990, 80, 339, "Input",ExpressionUUID->"5a0c886b-9e15-463f-ac87-b14f1e013541"],
Cell[4567, 128, 406, 10, 54, "Output",ExpressionUUID->"afb3b10a-c5a5-4fab-9d0e-befcedf5044d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5010, 143, 3160, 67, 135, "Input",ExpressionUUID->"65f38416-f4be-4ec4-94cc-aa16e40a8d87"],
Cell[8173, 212, 1436, 30, 47, "Output",ExpressionUUID->"fbd2a9e7-1737-4367-99fb-1d5e65e10149"],
Cell[9612, 244, 1458, 33, 56, "Output",ExpressionUUID->"c33435f2-494a-4b87-b707-aa86d0d47c83"],
Cell[11073, 279, 1462, 31, 45, "Output",ExpressionUUID->"e0e96772-d14a-4878-8ccf-5c7794f2d4ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12572, 315, 1451, 35, 71, "Input",ExpressionUUID->"50d6252f-a1a6-46b3-becb-275b35009274"],
Cell[14026, 352, 1734, 37, 53, "Output",ExpressionUUID->"70e79761-878a-47ee-8ff7-f427c5da2b86"],
Cell[15763, 391, 1166, 17, 33, "Output",ExpressionUUID->"16c7f253-60de-4beb-936e-04b303ffb634"],
Cell[16932, 410, 3209, 83, 112, "Output",ExpressionUUID->"f3b1075c-212e-4e94-85a6-ecae27ee71f0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20190, 499, 185, 3, 68, "Section",ExpressionUUID->"952d3201-0e2e-4f47-82c8-15c4f127e839"],
Cell[CellGroupData[{
Cell[20400, 506, 3841, 112, 463, "Input",ExpressionUUID->"87cf1e48-381a-43f7-8701-7fa6f6dba4a6"],
Cell[24244, 620, 683, 15, 56, "Output",ExpressionUUID->"3ff17701-7d46-4725-9a3d-2bc65cad3b67"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24964, 640, 4292, 94, 158, "Input",ExpressionUUID->"7f061fac-3a7f-4395-9b7a-1ce9dd132807"],
Cell[29259, 736, 1701, 42, 47, "Output",ExpressionUUID->"87efcf9c-008b-4b1c-9b87-6838389db808"],
Cell[30963, 780, 1133, 28, 45, "Output",ExpressionUUID->"d87fc325-d612-4b80-9484-f69d12903152"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32133, 813, 1660, 41, 71, "Input",ExpressionUUID->"a27b90c3-2a3f-4168-a377-68380e58b6c7"],
Cell[33796, 856, 2451, 58, 88, "Output",ExpressionUUID->"90b1a9da-3daf-4bbc-bc31-f1495f5cd48a"],
Cell[36250, 916, 1185, 17, 33, "Output",ExpressionUUID->"7c06173e-9d16-42d0-81f0-1f143c82253a"],
Cell[37438, 935, 7087, 185, 249, "Output",ExpressionUUID->"27a6d6a5-eb1e-4c55-b07d-b1b937430f23"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44574, 1126, 293, 7, 107, "Section",ExpressionUUID->"4c4b678e-a184-4b9c-8eed-09fa12da6550"],
Cell[CellGroupData[{
Cell[44892, 1137, 6383, 167, 566, "Input",ExpressionUUID->"8732a03f-15e3-4fc9-aced-27116b68e420"],
Cell[51278, 1306, 604, 14, 56, "Output",ExpressionUUID->"e4d8feae-b840-4359-99f7-bbc6a9e963d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51919, 1325, 3852, 88, 156, "Input",ExpressionUUID->"ff854974-4528-4a1c-8f57-ea9a46a9b67d"],
Cell[55774, 1415, 3156, 76, 85, "Output",ExpressionUUID->"43d1648b-6d56-49bb-9c6e-4c10aa5c2c75"],
Cell[58933, 1493, 1577, 37, 56, "Output",ExpressionUUID->"63b2980d-c660-4d04-94aa-c44bcf7f618e"],
Cell[60513, 1532, 1579, 35, 45, "Output",ExpressionUUID->"167cfe8b-970a-4dbf-b7de-a851dd6bf4b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62129, 1572, 1631, 43, 51, "Input",ExpressionUUID->"68e92d6f-9a74-425d-8ae5-136feffabd88"],
Cell[63763, 1617, 4028, 104, 121, "Output",ExpressionUUID->"aad7dc11-55fb-4b8f-959d-97a5be7c5d9c"],
Cell[67794, 1723, 1191, 18, 33, "Output",ExpressionUUID->"788ce44a-5912-49bd-8cb1-b5dc972b4217"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69034, 1747, 262, 6, 107, "Section",ExpressionUUID->"63908919-2cbe-40db-b630-057c70bcd2f0"],
Cell[CellGroupData[{
Cell[69321, 1757, 6365, 166, 566, "Input",ExpressionUUID->"22a85354-a3d2-497f-933f-510617297273"],
Cell[75689, 1925, 870, 23, 56, "Output",ExpressionUUID->"bd681340-6a19-4872-9aa3-4e1e13379a19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76596, 1953, 3854, 88, 156, "Input",ExpressionUUID->"78582c36-93c8-4b6d-a0b8-3f4c3b2a1d94"],
Cell[80453, 2043, 3082, 75, 85, "Output",ExpressionUUID->"8d9ea770-c24f-4a91-b03a-822d711eaf2a"],
Cell[83538, 2120, 1886, 48, 61, "Output",ExpressionUUID->"22a91aa1-c802-4b78-8312-e612933a6a38"],
Cell[85427, 2170, 1948, 46, 61, "Output",ExpressionUUID->"00ff69d8-f6e4-43f2-bc4b-4c82d07b5356"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87412, 2221, 2400, 67, 113, "Input",ExpressionUUID->"ff90f6a1-9292-4536-a5b9-d2b02dae63cf"],
Cell[89815, 2290, 4690, 125, 150, "Output",ExpressionUUID->"d63ffe8d-f33e-4cb3-b139-98dc979adcc3"],
Cell[94508, 2417, 1170, 18, 33, "Output",ExpressionUUID->"7bc98d5f-d4b8-4c4a-a7b2-c914a888aa74"],
Cell[95681, 2437, 1169, 18, 56, "Output",ExpressionUUID->"b8a51f3f-4f32-471d-866a-472814ba3b2d"]
}, Open  ]]
}, Open  ]]
}
]
*)

